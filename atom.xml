<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Michael Minter]]></title>
  <link href="http://moorberry.net/atom.xml" rel="self"/>
  <link href="http://moorberry.net/"/>
  <updated>2014-04-14T00:03:31-05:00</updated>
  <id>http://moorberry.net/</id>
  <author>
    <name><![CDATA[Michael Minter]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Database Version Control with MySQL Utilities]]></title>
    <link href="http://moorberry.net/blog/database-version-control/"/>
    <updated>2014-04-13T23:30:00-05:00</updated>
    <id>http://moorberry.net/blog/database-version-control</id>
    <content type="html"><![CDATA[<p>The following steps are meant to capture a snapshot of your development database and your staging/production database, compare the two, and provide SQL to consolidate the differences.</p>

<!-- more -->


<p>This article relates to one of many methods for <strong>database version control</strong> in a singular or team-based environment.</p>

<h2>MySQL Workbench</h2>

<p>Having <strong>MySQL Workbench</strong> is not mandatory for this process. But it&#8217;s a nice interface to consolidate the suite of tools that <strong>MySQL</strong> offers.</p>

<p>Download <a href="http://dev.mysql.com/downloads/tools/workbench/">http://dev.mysql.com/downloads/tools/workbench/</a></p>

<h2>MySQL Utilities</h2>

<p><strong>MySQL Utilities</strong> will install the required programs to finish the fowllowing steps.</p>

<p>Download <a href="http://dev.mysql.com/doc/workbench/en/mysql-utilities.html">http://dev.mysql.com/doc/workbench/en/mysql-utilities.html</a></p>

<h2>Verify MySQL Utilities</h2>

<p>Open <strong>MySQL Workbench</strong>.</p>

<p>Start <strong>MySQL Utilities</strong> from <strong>MySQL Workbench</strong>.</p>

<p><img src="http://dev.mysql.com/doc/workbench/en/images/wb-mysql-utilities-open.png" width="100%" /></p>

<p>The available <strong>MySQL Utilities</strong> programs can be seen in the console window below with the &#8220;help&#8221; command executed.</p>

<p><img src="http://dev.mysql.com/doc/workbench/en/images/wb-mysql-utilities-console.png" width="100%" /></p>

<p>The same can be done by entering <code>mysqluc -e "help utilities"</code> into your console.</p>

<p>If you receive the following error.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Traceback (most recent call last):
</span><span class='line'>  File "/bin/mysqluc", line 23, in &lt;module&gt;
</span><span class='line'>  from mysql.utilities.common.options import license_callback, UtilitiesParser
</span><span class='line'>File "/Library/Python/2.7/site-packages/mysql/utilities/common/options.py", line 34, in     &lt;module&gt;
</span><span class='line'>from mysql.connector.conversion import MySQLConverter
</span><span class='line'>ImportError: No module named connector.conversion</span></code></pre></td></tr></table></div></figure>


<blockquote><p><strong>ImportError: No module named connector.conversion</strong></p></blockquote>

<p><strong>MySQL Utilities</strong> assumes that the <strong>MySQL Connector</strong> for <strong>Python</strong> has been installed.</p>

<p>Download it here <a href="http://dev.mysql.com/downloads/connector/python/">http://dev.mysql.com/downloads/connector/python/</a></p>

<h2>Compare Databases with mysqldbcompare</h2>

<p>Run <strong>mysqldbcompare</strong>.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~$ mysqldbcompare --server1=&lt;user&gt;:&lt;password&gt;@&lt;host&gt; --server2=&lt;user&gt;:&lt;password&gt;@localhost dwh_production:dwh_development --run-all-tests --skip-data-check --difftype=sql
</span><span class='line'># server1 on localhost: ... connected.
</span><span class='line'># server2 on localhost: ... connected.
</span><span class='line'># Checking databases dwh_production on server1 and dwh_development on server2
</span><span class='line'>#</span></code></pre></td></tr></table></div></figure>


<p>If you can&#8217;t connect to your database directly, but can <strong>SSH</strong> into the platform that the database server is located on, run:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~$ ssh -f -N -L 3307:localhost:3306 &lt;user&gt;@&lt;server&gt;</span></code></pre></td></tr></table></div></figure>


<p>Run <strong>mysqldbcompare</strong>.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~$ mysqldbcompare --server1=&lt;user&gt;:&lt;password&gt;@localhost:3307 --server2=&lt;user&gt;:&lt;password&gt;@localhost dwh_production:dwh_development --run-all-tests --skip-data-check --difftype=sql
</span><span class='line'># server1 on localhost: ... connected.
</span><span class='line'># server2 on localhost: ... connected.
</span><span class='line'># Checking databases dwh_production on server1 and dwh_development on server2
</span><span class='line'>#</span></code></pre></td></tr></table></div></figure>


<p><strong>TIP:</strong> Generate a file with the above output.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~$ mysqldbcompare --server1=&lt;database_user&gt;:&lt;database_password&gt;@localhost:3307 --server2=&lt;user&gt;:&lt;password&gt;@localhost dwh_production:dwh_development --run-all-tests --skip-data-check --difftype=sql &gt;&gt; mysqldbcompare.sql</span></code></pre></td></tr></table></div></figure>


<p>Now you have all the SQL to <strong>ALTER</strong> your production database structure so that it matches up with your development database structure.</p>

<h2>Import</h2>

<p>Import database <strong>ALTER</strong> statements.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~$ mysqlimport -u &lt;user&gt; -p&lt;password&gt; dwh_production mysqldbcompare.sql</span></code></pre></td></tr></table></div></figure>


<h2>Verify</h2>

<p>Get a <strong>DIFF</strong> of the two databases.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~$ mysqldbcompare --server1=&lt;database_user&gt;:&lt;database_password&gt;@localhost:3307 --server2=&lt;user&gt;:&lt;password&gt;@localhost dwh_production:dwh_development --run-all-tests --skip-data-check</span></code></pre></td></tr></table></div></figure>


<h2>Resources</h2>

<ul>
<li><a href="http://dev.mysql.com/doc/mysql-utilities/1.3/en/mysqldbcompare.html">http://dev.mysql.com/doc/mysql-utilities/1.3/en/mysqldbcompare.html</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Multi Column Unique Indexes]]></title>
    <link href="http://moorberry.net/blog/multi-column-unique-indexes/"/>
    <updated>2014-01-15T13:45:00-06:00</updated>
    <id>http://moorberry.net/blog/multi-column-unique-indexes</id>
    <content type="html"><![CDATA[<p>When a database key is created from a combination of two or more columns, the key is called a <strong>composite key</strong>. Each column may not be unique by itself within the database table but when combined with the other column(s) in the composite key, the combination is unique.</p>

<!-- more -->


<p>The following data is taken from the <strong>Google DFP Report API</strong> example source code.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">src_dfp</span><span class="o">`</span> <span class="p">(</span>
</span><span class='line'>  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="n">unsigned</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">ad_unit_1</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">COLLATE</span> <span class="n">utf8_unicode_ci</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">ad_unit_2</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">COLLATE</span> <span class="n">utf8_unicode_ci</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">ad_unit_id_1</span><span class="o">`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">ad_unit_id_2</span><span class="o">`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">advertiser_id</span><span class="o">`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">advertiser_name</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">COLLATE</span> <span class="n">utf8_unicode_ci</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">creative_id</span><span class="o">`</span> <span class="nb">bigint</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">creative_name</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">COLLATE</span> <span class="n">utf8_unicode_ci</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="nb">date</span><span class="o">`</span> <span class="nb">date</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">line_item_cost_per_unit</span><span class="o">`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">line_item_cost_type</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">COLLATE</span> <span class="n">utf8_unicode_ci</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">line_item_end_date_time</span><span class="o">`</span> <span class="n">datetime</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">line_item_id</span><span class="o">`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">line_item_name</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">COLLATE</span> <span class="n">utf8_unicode_ci</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">line_item_start_date_time</span><span class="o">`</span> <span class="n">datetime</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">line_item_type</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">COLLATE</span> <span class="n">utf8_unicode_ci</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">merged_ad_server_clicks</span><span class="o">`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">merged_ad_server_impressions</span><span class="o">`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">order_end_date_time</span><span class="o">`</span> <span class="n">datetime</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">order_id</span><span class="o">`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">order_name</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">COLLATE</span> <span class="n">utf8_unicode_ci</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">order_start_date_time</span><span class="o">`</span> <span class="n">datetime</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="o">`</span><span class="n">created_at</span><span class="o">`</span> <span class="n">datetime</span> <span class="k">DEFAULT</span> <span class="n">NOW</span><span class="p">(),</span>
</span><span class='line'>  <span class="o">`</span><span class="n">updated_at</span><span class="o">`</span> <span class="n">datetime</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
</span><span class='line'>  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">),</span>
</span><span class='line'>  <span class="k">UNIQUE</span> <span class="k">KEY</span> <span class="o">`</span><span class="n">composite_dfp</span><span class="o">`</span> <span class="p">(</span><span class="o">`</span><span class="nb">date</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">ad_unit_id_1</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">ad_unit_id_2</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">advertiser_id</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">creative_id</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">line_item_id</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">order_id</span><span class="o">`</span><span class="p">)</span>
</span><span class='line'><span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span> <span class="k">COLLATE</span><span class="o">=</span><span class="n">utf8_unicode_ci</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Or to modify an existing table:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">src_dfp</span> <span class="k">ADD</span> <span class="k">UNIQUE</span> <span class="k">index</span> <span class="n">composite_dfp</span> <span class="p">(</span><span class="nb">date</span><span class="p">,</span> <span class="n">ad_unit_id_1</span><span class="p">,</span> <span class="n">ad_unit_id_2</span><span class="p">,</span> <span class="n">advertiser_id</span><span class="p">,</span> <span class="n">creative_id</span><span class="p">,</span> <span class="n">line_item_id</span><span class="p">,</span> <span class="n">order_id</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>




<p></p>


<p>Which will generate these keys:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>+------------+---------------+-------------------+---------------+-----------+-------------+----------+--------+
</span><span class='line'>| Non Unique |   Key Name    | Sequence in Index |  Column Name  | Collation | Cardinality | Sub Part | Packed |
</span><span class='line'>+------------+---------------+-------------------+---------------+-----------+-------------+----------+--------+
</span><span class='line'>|          0 | PRIMARY       |                 1 | id            | A         |           0 | NULL     | NULL   |
</span><span class='line'>|          0 | composite_dfp |                 1 | date          | A         |           1 | NULL     | NULL   |
</span><span class='line'>|          0 | composite_dfp |                 2 | ad_unit_id_1  | A         |           2 | NULL     | NULL   |
</span><span class='line'>|          0 | composite_dfp |                 3 | ad_unit_id_2  | A         |           3 | NULL     | NULL   |
</span><span class='line'>|          0 | composite_dfp |                 4 | advertiser_id | A         |           4 | NULL     | NULL   |
</span><span class='line'>|          0 | composite_dfp |                 5 | creative_id   | A         |           5 | NULL     | NULL   |
</span><span class='line'>|          0 | composite_dfp |                 6 | line_item_id  | A         |           6 | NULL     | NULL   |
</span><span class='line'>|          0 | composite_dfp |                 7 | order_id      | A         |           7 | NULL     | NULL   |
</span><span class='line'>+------------+---------------+-------------------+---------------+-----------+-------------+----------+--------+
</span></code></pre></td></tr></table></div></figure>


<p><em>Don&#8217;t let the color highlighting above fool you. <strong>date</strong> is another column in the table.</em></p>

<p>Now, if you try to rerun the same import against existing data, you&#8217;ll receive the following error message: <code>Duplicate entry '2014-01-14-83243539-236269939-15980539-32298017059-67086499-1643' for key 'composite_dfp'</code></p>

<p>A <strong>UNIQUE</strong> index creates a constraint such that all values in the index must be distinct. An error occurs if you try to add a new row with a key value that matches an existing row. This constraint does not apply to NULL values <strong>except for the BDB storage engine</strong>. For other engines, a UNIQUE index allows multiple NULL values for columns that can contain NULL. <a href="http://dev.mysql.com/doc/refman/5.0/en/create-index.html">Document Source</a></p>

<h2>MySQL Workbench</h2>

<p><strong>1.</strong> Go to the edit window for the table you&#8217;re working on</p>

<p><img src="http://moorberry.net/images/posts/mysql-workbench.jpg" alt="MySQL Workbench" width="100%" /></p>

<p><strong>2.</strong> Add a new index in the far-left screen by clicking on the new index row and giving the new index a name<br />
<strong>3.</strong> Select the <strong>UNIQUE</strong> type<br />
<strong>4.</strong> Check all of the corresponding index columns to the right</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Postgres: Search and Sort by Distance]]></title>
    <link href="http://moorberry.net/blog/postgres-search-distance/"/>
    <updated>2013-12-11T13:01:00-06:00</updated>
    <id>http://moorberry.net/blog/postgres-search-distance</id>
    <content type="html"><![CDATA[<p>Request users by radial distance and sort by nearest to farthest, vice versa, or whatever other attributes you&#8217;d like to include.</p>

<!-- more -->


<p>Searching for a user by distance, in your database, is easy with <strong>Postgres</strong>. Just create a users table with, at minimum, columns named <em>latitude</em> and <em>longitude</em>.</p>

<h2>Data</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">postgres</span><span class="o">=</span><span class="c"># SELECT * FROM users;</span>
</span><span class='line'>+----+------+----------+-----------+
</span><span class='line'>| id | name | latitude | longitude |
</span><span class='line'>+----+------+----------+-----------+
</span></code></pre></td></tr></table></div></figure>


<h2>SQL</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">distance</span>
</span><span class='line'><span class="k">FROM</span>
</span><span class='line'><span class="p">(</span> <span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="p">((</span><span class="n">ACOS</span><span class="p">(</span><span class="n">SIN</span><span class="p">(</span><span class="o">#</span><span class="err">{</span><span class="n">latitude</span><span class="err">}</span> <span class="o">*</span> <span class="n">PI</span><span class="p">()</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span> <span class="o">*</span> <span class="n">SIN</span><span class="p">(</span><span class="n">u</span><span class="p">.</span><span class="n">latitude</span> <span class="o">*</span> <span class="n">PI</span><span class="p">()</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span> <span class="o">+</span> <span class="n">COS</span><span class="p">(</span><span class="o">#</span><span class="err">{</span><span class="n">latitude</span><span class="err">}</span> <span class="o">*</span> <span class="n">PI</span><span class="p">()</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span> <span class="o">*</span> <span class="n">COS</span><span class="p">(</span><span class="n">u</span><span class="p">.</span><span class="n">latitude</span> <span class="o">*</span> <span class="n">PI</span><span class="p">()</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span> <span class="o">*</span> <span class="n">COS</span><span class="p">((</span><span class="o">#</span><span class="err">{</span><span class="n">longitude</span><span class="err">}</span> <span class="o">-</span> <span class="n">u</span><span class="p">.</span><span class="n">longitude</span><span class="p">)</span> <span class="o">*</span> <span class="n">PI</span><span class="p">()</span> <span class="o">/</span> <span class="mi">180</span><span class="p">))</span> <span class="o">*</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">PI</span><span class="p">())</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1</span><span class="p">.</span><span class="mi">1515</span><span class="p">)</span> <span class="k">as</span> <span class="n">distance</span>
</span><span class='line'><span class="k">FROM</span> <span class="n">users</span> <span class="n">u</span> <span class="p">)</span> <span class="n">d</span>
</span><span class='line'><span class="k">WHERE</span> <span class="n">distance</span> <span class="o">&lt;=</span> <span class="mi">5</span>
</span><span class='line'><span class="k">ORDER</span> <span class="k">BY</span> <span class="n">distance</span> <span class="k">ASC</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Matches all users <code>WHERE distance &lt;= 5</code> (less than or equal to five <strong>miles</strong>).</p>

<p>To change the distance to kilometers&mdash;multiply the output number by 1.609344 (1 mile == 1.609344 kilometers).</p>

<p>Replace <code>#{latitude}</code> with the value for the latitude you want to match against the database and do the same for <code>#{longitude}</code></p>

<p>This will work in any SQL relational database, including <strong>MySQL</strong> and <strong>Oracle</strong>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CSV Special Character]]></title>
    <link href="http://moorberry.net/blog/csv-special-character/"/>
    <updated>2013-10-08T23:52:00-05:00</updated>
    <id>http://moorberry.net/blog/csv-special-character</id>
    <content type="html"><![CDATA[<p>Separate CSV data with a special character (example: thorn &thorn;).</p>

<!-- more -->


<p><strong>Google DFP</strong> (Double-click for publishers) uses a special character in their CSV exports. Specifically the thorn character and it&#8217;s a pain. But Ruby can make it better.</p>

<p>You can skip to the bottom of this article for the neccessary code or read on from here for more details about figuring out the path to certainty.</p>

<h2>Unicode</h2>

<p>Find the unicode character. For my example the thorn character <strong>&thorn;</strong> is represented as <strong>u00FE</strong>.</p>

<h3>List Encoding Types available to Ruby 2</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>2.0.0p0 :001 &gt; Encoding.name_list
</span><span class='line'> <span class="o">=</span>&gt; <span class="o">[</span><span class="s2">&quot;ASCII-8BIT&quot;</span>, <span class="s2">&quot;UTF-8&quot;</span>, <span class="s2">&quot;US-ASCII&quot;</span>, <span class="s2">&quot;Big5&quot;</span>, <span class="s2">&quot;Big5-HKSCS&quot;</span>, <span class="s2">&quot;Big5-UAO&quot;</span>, <span class="s2">&quot;CP949&quot;</span>, <span class="s2">&quot;Emacs-Mule&quot;</span>, <span class="s2">&quot;EUC-JP&quot;</span>, <span class="s2">&quot;EUC-KR&quot;</span>, <span class="s2">&quot;EUC-TW&quot;</span>, <span class="s2">&quot;GB18030&quot;</span>, <span class="s2">&quot;GBK&quot;</span>, <span class="s2">&quot;ISO-8859-1&quot;</span>, <span class="s2">&quot;ISO-8859-2&quot;</span>, <span class="s2">&quot;ISO-8859-3&quot;</span>, <span class="s2">&quot;ISO-8859-4&quot;</span>, <span class="s2">&quot;ISO-8859-5&quot;</span>, <span class="s2">&quot;ISO-8859-6&quot;</span>, <span class="s2">&quot;ISO-8859-7&quot;</span>, <span class="s2">&quot;ISO-8859-8&quot;</span>, <span class="s2">&quot;ISO-8859-9&quot;</span>, <span class="s2">&quot;ISO-8859-10&quot;</span>, <span class="s2">&quot;ISO-8859-11&quot;</span>, <span class="s2">&quot;ISO-8859-13&quot;</span>, <span class="s2">&quot;ISO-8859-14&quot;</span>, <span class="s2">&quot;ISO-8859-15&quot;</span>, <span class="s2">&quot;ISO-8859-16&quot;</span>, <span class="s2">&quot;KOI8-R&quot;</span>, <span class="s2">&quot;KOI8-U&quot;</span>, <span class="s2">&quot;Shift_JIS&quot;</span>, <span class="s2">&quot;UTF-16BE&quot;</span>, <span class="s2">&quot;UTF-16LE&quot;</span>, <span class="s2">&quot;UTF-32BE&quot;</span>, <span class="s2">&quot;UTF-32LE&quot;</span>, <span class="s2">&quot;Windows-31J&quot;</span>, <span class="s2">&quot;Windows-1251&quot;</span>, <span class="s2">&quot;BINARY&quot;</span>, <span class="s2">&quot;IBM437&quot;</span>, <span class="s2">&quot;CP437&quot;</span>, <span class="s2">&quot;IBM737&quot;</span>, <span class="s2">&quot;CP737&quot;</span>, <span class="s2">&quot;IBM775&quot;</span>, <span class="s2">&quot;CP775&quot;</span>, <span class="s2">&quot;CP850&quot;</span>, <span class="s2">&quot;IBM850&quot;</span>, <span class="s2">&quot;IBM852&quot;</span>, <span class="s2">&quot;CP852&quot;</span>, <span class="s2">&quot;IBM855&quot;</span>, <span class="s2">&quot;CP855&quot;</span>, <span class="s2">&quot;IBM857&quot;</span>, <span class="s2">&quot;CP857&quot;</span>, <span class="s2">&quot;IBM860&quot;</span>, <span class="s2">&quot;CP860&quot;</span>, <span class="s2">&quot;IBM861&quot;</span>, <span class="s2">&quot;CP861&quot;</span>, <span class="s2">&quot;IBM862&quot;</span>, <span class="s2">&quot;CP862&quot;</span>, <span class="s2">&quot;IBM863&quot;</span>, <span class="s2">&quot;CP863&quot;</span>, <span class="s2">&quot;IBM864&quot;</span>, <span class="s2">&quot;CP864&quot;</span>, <span class="s2">&quot;IBM865&quot;</span>, <span class="s2">&quot;CP865&quot;</span>, <span class="s2">&quot;IBM866&quot;</span>, <span class="s2">&quot;CP866&quot;</span>, <span class="s2">&quot;IBM869&quot;</span>, <span class="s2">&quot;CP869&quot;</span>, <span class="s2">&quot;Windows-1258&quot;</span>, <span class="s2">&quot;CP1258&quot;</span>, <span class="s2">&quot;GB1988&quot;</span>, <span class="s2">&quot;macCentEuro&quot;</span>, <span class="s2">&quot;macCroatian&quot;</span>, <span class="s2">&quot;macCyrillic&quot;</span>, <span class="s2">&quot;macGreek&quot;</span>, <span class="s2">&quot;macIceland&quot;</span>, <span class="s2">&quot;macRoman&quot;</span>, <span class="s2">&quot;macRomania&quot;</span>, <span class="s2">&quot;macThai&quot;</span>, <span class="s2">&quot;macTurkish&quot;</span>, <span class="s2">&quot;macUkraine&quot;</span>, <span class="s2">&quot;CP950&quot;</span>, <span class="s2">&quot;Big5-HKSCS:2008&quot;</span>, <span class="s2">&quot;CP951&quot;</span>, <span class="s2">&quot;stateless-ISO-2022-JP&quot;</span>, <span class="s2">&quot;eucJP&quot;</span>, <span class="s2">&quot;eucJP-ms&quot;</span>, <span class="s2">&quot;euc-jp-ms&quot;</span>, <span class="s2">&quot;CP51932&quot;</span>, <span class="s2">&quot;EUC-JP-2004&quot;</span>, <span class="s2">&quot;EUC-JISX0213&quot;</span>, <span class="s2">&quot;eucKR&quot;</span>, <span class="s2">&quot;eucTW&quot;</span>, <span class="s2">&quot;GB2312&quot;</span>, <span class="s2">&quot;EUC-CN&quot;</span>, <span class="s2">&quot;eucCN&quot;</span>, <span class="s2">&quot;GB12345&quot;</span>, <span class="s2">&quot;CP936&quot;</span>, <span class="s2">&quot;ISO-2022-JP&quot;</span>, <span class="s2">&quot;ISO2022-JP&quot;</span>, <span class="s2">&quot;ISO-2022-JP-2&quot;</span>, <span class="s2">&quot;ISO2022-JP2&quot;</span>, <span class="s2">&quot;CP50220&quot;</span>, <span class="s2">&quot;CP50221&quot;</span>, <span class="s2">&quot;ISO8859-1&quot;</span>, <span class="s2">&quot;Windows-1252&quot;</span>, <span class="s2">&quot;CP1252&quot;</span>, <span class="s2">&quot;ISO8859-2&quot;</span>, <span class="s2">&quot;Windows-1250&quot;</span>, <span class="s2">&quot;CP1250&quot;</span>, <span class="s2">&quot;ISO8859-3&quot;</span>, <span class="s2">&quot;ISO8859-4&quot;</span>, <span class="s2">&quot;ISO8859-5&quot;</span>, <span class="s2">&quot;ISO8859-6&quot;</span>, <span class="s2">&quot;Windows-1256&quot;</span>, <span class="s2">&quot;CP1256&quot;</span>, <span class="s2">&quot;ISO8859-7&quot;</span>, <span class="s2">&quot;Windows-1253&quot;</span>, <span class="s2">&quot;CP1253&quot;</span>, <span class="s2">&quot;ISO8859-8&quot;</span>, <span class="s2">&quot;Windows-1255&quot;</span>, <span class="s2">&quot;CP1255&quot;</span>, <span class="s2">&quot;ISO8859-9&quot;</span>, <span class="s2">&quot;Windows-1254&quot;</span>, <span class="s2">&quot;CP1254&quot;</span>, <span class="s2">&quot;ISO8859-10&quot;</span>, <span class="s2">&quot;ISO8859-11&quot;</span>, <span class="s2">&quot;TIS-620&quot;</span>, <span class="s2">&quot;Windows-874&quot;</span>, <span class="s2">&quot;CP874&quot;</span>, <span class="s2">&quot;ISO8859-13&quot;</span>, <span class="s2">&quot;Windows-1257&quot;</span>, <span class="s2">&quot;CP1257&quot;</span>, <span class="s2">&quot;ISO8859-14&quot;</span>, <span class="s2">&quot;ISO8859-15&quot;</span>, <span class="s2">&quot;ISO8859-16&quot;</span>, <span class="s2">&quot;CP878&quot;</span>, <span class="s2">&quot;MacJapanese&quot;</span>, <span class="s2">&quot;MacJapan&quot;</span>, <span class="s2">&quot;ASCII&quot;</span>, <span class="s2">&quot;ANSI_X3.4-1968&quot;</span>, <span class="s2">&quot;646&quot;</span>, <span class="s2">&quot;UTF-7&quot;</span>, <span class="s2">&quot;CP65000&quot;</span>, <span class="s2">&quot;CP65001&quot;</span>, <span class="s2">&quot;UTF8-MAC&quot;</span>, <span class="s2">&quot;UTF-8-MAC&quot;</span>, <span class="s2">&quot;UTF-8-HFS&quot;</span>, <span class="s2">&quot;UTF-16&quot;</span>, <span class="s2">&quot;UTF-32&quot;</span>, <span class="s2">&quot;UCS-2BE&quot;</span>, <span class="s2">&quot;UCS-4BE&quot;</span>, <span class="s2">&quot;UCS-4LE&quot;</span>, <span class="s2">&quot;CP932&quot;</span>, <span class="s2">&quot;csWindows31J&quot;</span>, <span class="s2">&quot;SJIS&quot;</span>, <span class="s2">&quot;PCK&quot;</span>, <span class="s2">&quot;CP1251&quot;</span>, <span class="s2">&quot;UTF8-DoCoMo&quot;</span>, <span class="s2">&quot;SJIS-DoCoMo&quot;</span>, <span class="s2">&quot;UTF8-KDDI&quot;</span>, <span class="s2">&quot;SJIS-KDDI&quot;</span>, <span class="s2">&quot;ISO-2022-JP-KDDI&quot;</span>, <span class="s2">&quot;stateless-ISO-2022-JP-KDDI&quot;</span>, <span class="s2">&quot;UTF8-SoftBank&quot;</span>, <span class="s2">&quot;SJIS-SoftBank&quot;</span>, <span class="s2">&quot;locale&quot;</span>, <span class="s2">&quot;external&quot;</span>, <span class="s2">&quot;filesystem&quot;</span>, <span class="s2">&quot;internal&quot;</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Determine Encoding Type</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Encoding</span><span class="o">.</span><span class="n">name_list</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">encoding</span><span class="o">|</span>
</span><span class='line'>  <span class="no">CSV</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="p">{</span> <span class="n">encoding</span><span class="ss">:encoding</span><span class="p">,</span> <span class="ss">:col_sep</span> <span class="o">=&gt;</span> <span class="s2">&quot;\u00FE&quot;</span> <span class="p">})</span> <span class="k">do</span> <span class="o">|</span><span class="n">row</span><span class="o">|</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;===== </span><span class="si">#{</span><span class="n">encoding</span><span class="si">}</span><span class="s2"> =====&quot;</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="n">row</span><span class="o">.</span><span class="n">inspect</span>
</span><span class='line'>    <span class="k">break</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Use Thorn as Delimiter in CSV</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">CSV</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="p">{</span> <span class="n">encoding</span><span class="ss">:&#39;ISO-8859-1&#39;</span><span class="p">,</span> <span class="ss">:col_sep</span> <span class="o">=&gt;</span> <span class="s2">&quot;\u00FE&quot;</span> <span class="p">})</span> <span class="k">do</span> <span class="o">|</span><span class="n">row</span><span class="o">|</span>
</span><span class='line'>  <span class="c1"># your code here</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Rails 2 and acts_as_paranoid]]></title>
    <link href="http://moorberry.net/blog/rails-2-acts-as-paranoid/"/>
    <updated>2013-08-15T16:31:00-05:00</updated>
    <id>http://moorberry.net/blog/rails-2-acts-as-paranoid</id>
    <content type="html"><![CDATA[<p>Overrides some basic Active Record methods for the current model so that calling #destroy sets a <em>deleted_at</em> field to the current timestamp.</p>

<!-- more -->


<h2>Setup</h2>

<p><strong>Create migration file</strong></p>

<p>acts_as_paranoid, by default, assumes the table has a <em>deleted_at</em> date/time field.  Most normal model operations will work, but there will be some oddities.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ script/server generate migration deleted_at:datetime</span></code></pre></td></tr></table></div></figure>


<p>And then modify your migration file (app/db/migrations/000000000000_add_deleted_atâ€¦rb)to look something like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">AddDeletedAtToWidgets</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">up</span>
</span><span class='line'>    <span class="n">add_column</span> <span class="ss">:widgets</span><span class="p">,</span> <span class="ss">:deleted_at</span><span class="p">,</span> <span class="ss">:datetime</span><span class="p">,</span> <span class="ss">:null</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">down</span>
</span><span class='line'>    <span class="n">remove_column</span> <span class="ss">:widgets</span><span class="p">,</span> <span class="ss">:deleted_at</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Add the gem source to your Gemfile</strong> (app/Gemfile)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="s1">&#39;acts_as_paranoid&#39;</span><span class="p">,</span> <span class="ss">:git</span> <span class="o">=&gt;</span> <span class="s1">&#39;git://github.com/technoweenie/acts_as_paranoid.git&#39;</span><span class="p">,</span> <span class="ss">:branch</span> <span class="o">=&gt;</span> <span class="s1">&#39;integration_gem&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Run bundler</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">$</span> <span class="n">bundle</span> <span class="n">install</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Add the requestor to your model</strong> (app/models/widgets.rb)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Widget</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="n">acts_as_paranoid</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you&#8217;d like to set a <strong>custom column for acts_as_paranoid</strong> just use the following options in your class method:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">acts_as_paranoid</span> <span class="ss">:with</span> <span class="o">=&gt;</span> <span class="s1">&#39;destroyed_at&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Use</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Widget</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="ss">:all</span><span class="p">)</span>
</span><span class='line'><span class="c1"># =&gt; SELECT * FROM widgets WHERE widgets.deleted_at IS NULL</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Widget</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="ss">:first</span><span class="p">,</span> <span class="ss">:conditions</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s1">&#39;title = ?&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="o">]</span><span class="p">,</span> <span class="ss">:order</span> <span class="o">=&gt;</span> <span class="s1">&#39;title&#39;</span><span class="p">)</span>
</span><span class='line'><span class="c1"># =&gt; SELECT * FROM widgets WHERE widgets.deleted_at IS NULL AND title = &#39;test&#39; ORDER BY title LIMIT 1</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Widget</span><span class="o">.</span><span class="n">find_with_deleted</span><span class="p">(</span><span class="ss">:all</span><span class="p">)</span>
</span><span class='line'><span class="c1"># =&gt; SELECT * FROM widgets</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Widget</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="ss">:all</span><span class="p">,</span> <span class="ss">:with_deleted</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">)</span>
</span><span class='line'><span class="c1"># =&gt; SELECT * FROM widgets</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Widget</span><span class="o">.</span><span class="n">find_with_deleted</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">deleted?</span>
</span><span class='line'><span class="c1"># =&gt; Returns true if the record was previously destroyed, false if not </span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Widget</span><span class="o">.</span><span class="n">count</span>
</span><span class='line'><span class="c1"># =&gt; SELECT COUNT(*) FROM widgets WHERE widgets.deleted_at IS NULL</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Widget</span><span class="o">.</span><span class="n">count</span> <span class="o">[</span><span class="s1">&#39;title = ?&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="o">]</span>
</span><span class='line'><span class="c1"># =&gt; SELECT COUNT(*) FROM widgets WHERE widgets.deleted_at IS NULL AND title = &#39;test&#39;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Widget</span><span class="o">.</span><span class="n">count_with_deleted</span>
</span><span class='line'><span class="c1"># =&gt; SELECT COUNT(*) FROM widgets</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Widget</span><span class="o">.</span><span class="n">delete_all</span>
</span><span class='line'><span class="c1"># =&gt; UPDATE widgets SET deleted_at = &#39;2013-08-15 13:01:59&#39;</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Widget</span><span class="o">.</span><span class="n">delete_all!</span>
</span><span class='line'><span class="c1"># =&gt; DELETE FROM widgets</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@widget</span><span class="o">.</span><span class="n">destroy</span>
</span><span class='line'><span class="c1"># =&gt; UPDATE widgets SET deleted_at = &#39;2013-08-15 13:01:59&#39; WHERE id = 1</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@widget</span><span class="o">.</span><span class="n">destroy!</span>
</span><span class='line'><span class="c1"># =&gt; DELETE FROM widgets WHERE id = 1</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@widget</span><span class="o">.</span><span class="n">recover!</span>
</span><span class='line'><span class="c1"># =&gt; UPDATE widgets SET deleted_at = NULL WHERE id = 1</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Android Javascript Debugging]]></title>
    <link href="http://moorberry.net/blog/android-javascript-debugging/"/>
    <updated>2013-08-12T11:23:00-05:00</updated>
    <id>http://moorberry.net/blog/android-javascript-debugging</id>
    <content type="html"><![CDATA[<p>As a web developer, I have to use <code>console.log</code> a lot to see what&#8217;s going on with Javascript in my web applications, and Android Browser does <strong>not</strong> make this <strong>an easy task</strong>.</p>

<!-- more -->


<p>Initial searches brought up articles suggesting use of the Android SDK, plugging my phone into my computer, setting up the debug bridge, et cetera. That&#8217;s a lot of work.</p>

<p>There is a way to do <strong>Javascript debugging</strong> entirely on your phone <strong>without the Android SDK</strong>.</p>

<p><strong>Install</strong> a log viewer from the Android Market (example: <em>logcat</em>). This shows all of your systems log messages. Most log viewers will let you search/filter. <strong>Search</strong> for the term, &#8221;<em>browser</em>&#8221;. All <code>console.log</code> messages will show up using this keyword.</p>

<p>One difference from desktop web inspectors: Android Browser <strong>only prints the first argument</strong> from <code>console.log</code>. So instead of:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;here&#39;s my variable &quot;</span><span class="p">,</span> <span class="kd">var</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>you should write it like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;here&#39;s my variable &quot;</span> <span class="o">+</span> <span class="kd">var</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[OpenOffice: Merge and Sort Data]]></title>
    <link href="http://moorberry.net/blog/openoffice-merge-and-sort-data/"/>
    <updated>2013-05-14T22:55:00-05:00</updated>
    <id>http://moorberry.net/blog/openoffice-merge-and-sort-data</id>
    <content type="html"><![CDATA[<p>You need to <strong>construct an array using a list of pre-existing values</strong> but firstly have to <strong>sort the order</strong> of that list.</p>

<!--more-->


<p>There are plenty of alternatives but I enjoy using <a href="http://www.openoffice.org/" target="_blank" title="OpenOffice"><strong>OpenOffice</strong></a> for these simple string inclusions.</p>

<p>OpenOffice is <strong>open source</strong> and available for use on <strong>all major operating systems</strong>.</p>

<!--## Let's Get Started-->


<h3>Collect Data</h3>

<p>Copy your list of values.</p>

<p>Select the top cell in the column you want your list to reside.</p>

<p><em>When you paste the values in OpenOffice, as long as they&#8217;re separated by a line break, OpenOffice will automatically separate each value into a new row of whichever column you&#8217;ve designated.</em></p>

<h3>Sort</h3>

<p>Sort the list by hilighting the data and perform the following:</p>

<p><code>Data &gt; Sort &gt; Options</code></p>

<p>Unselect the checkbox labeled &#8221;<em>Range contains column labels.</em>&#8221;</p>

<p>Click <code>OK</code></p>

<p><em>This option prevents column headers from being sorted with the rest of the data. Since we don&#8217;t have any column headers, like in a CSV file, we need to deactivate this feature.</em></p>

<p><img src="http://moorberry.net/images/posts/openoffice-1.jpg" alt="OpenOffice" width="100%" /></p>

<h3>Prepare</h3>

<p>Create the prepending or appending content at the top of the column to the left or right of the working list.</p>

<p>Point your cursor to the bottom-right corner of the cell you just filled, hold down your left mouse button, and move downwards to the bottom of the working column.</p>

<p><em>This action will copy the active cell to all of the other cells touched by your hover action. Do this over again for further columns.</em></p>

<h3>Merge</h3>

<p>Use the following Calc function in the column that you want the new data to be returned.</p>

<blockquote><p><a href="http://wiki.openoffice.org/wiki/Documentation/How_Tos/Calc:_CONCATENATE_function" target="_blank" alt="CONCATENATE Documentation"><strong>Concatenate</strong></a>: Combines several text strings into one string.</p></blockquote>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>=CONCATENATE( A1; ":"; B1; ":"; C1 )</span></code></pre></td></tr></table></div></figure>


<p>or you can use the simple version:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>= A1 & ":" & B1 & ":" & C1</span></code></pre></td></tr></table></div></figure>


<p><img src="http://moorberry.net/images/posts/openoffice-2.jpg" alt="OpenOffice" width="100%" /></p>

<p>Where cell <strong>A1</strong> contains <code>"</code>, cell <strong>B1</strong> contains <code>actionmailer</code>, and cell <strong>C1</strong> contains <code>",</code> returns <code>"actionamailer",</code>.</p>

<p>Hit <code>return</code></p>

<p>Just like when you copied the prep data, grab the bottom-right corner of the working cell and drag it directly down to the target end point.</p>

<p><em>This will copy the concatenation function across all of the modified cells. So if you change a value in another column, from its row, OpenOffice will generate new content for the concatenated cell.</em></p>

<p>Your column is now ready for inclusion in production-ready code. Just highlight the readied cells, copy, and paste into your program editor of choice.</p>

<h3>Further Reading</h3>

<p>When you paste the new column into your text editor you might notice special quotes that OpenOffice magicly replaces upon creation. You can disable the automatic conversion of ASCII &#8220;straight&#8221; quotes into typographic â€œcurlyâ€ quotes by going to:</p>

<p><code>Tools &gt; AutoCorrect Options &gt; Localized Options</code></p>

<p>Scan down to the container marked &#8220;Double Quotes&#8221; and make sure the checkbox labeled &#8220;Replace&#8221; is unchecked.</p>

<p>Click <code>OK</code></p>

<p><img src="http://moorberry.net/images/posts/openoffice-3.jpg" alt="OpenOffice" width="100%" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Book Review: Eloquent Ruby]]></title>
    <link href="http://moorberry.net/blog/eloquent-ruby-book-review/"/>
    <updated>2013-04-06T16:00:00-05:00</updated>
    <id>http://moorberry.net/blog/eloquent-ruby-book-review</id>
    <content type="html"><![CDATA[<p><a href="http://www.amazon.com/gp/product/0321584104/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0321584104&linkCode=as2&tag=moorberry-20" target="_blank">Eloquent Ruby</a><img src="http://www.assoc-amazon.com/e/ir?t=moorberry-20&l=as2&o=1&a=0321584104" width="1" height="1" border="0" alt="" style="border:none !important;display:inline;margin:0px !important;" />
 is a book about the Ruby programming language that focuses on <strong>Ruby programming style</strong> by teaching you how to write your code as a real world hardened Rubyist.</p>

<!--more-->


<p><a href="http://www.amazon.com/gp/offer-listing/0321584104/ref=as_li_tf_il?ie=UTF8&camp=1789&creative=9325&creativeASIN=0321584104&linkCode=am2&tag=moorberry-20" target="_blank" style="float:left;">
  <img border="0" src="http://ws.assoc-amazon.com/widgets/q?_encoding=UTF8&ASIN=0321584104&Format=_SL160_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=moorberry-20" style="display:inline-block;float:left;margin:0 10px 10px 0;" />
</a>
<img src="http://www.assoc-amazon.com/e/ir?t=moorberry-20&l=as2&o=1&a=0321584104" width="1" height="1" border="0" alt="" style="border:none !important;display:inline;float:left;margin:0px !important;" /></p>

<p>Be prepared, <strong>this is an unconventional Ruby book</strong>. To use the author&#8217;s, <a target="_blank" href="http://www.amazon.com/Russ-Olsen/e/B001JSCI5W/?_encoding=UTF8&camp=1789&creative=390957&linkCode=ur2&tag=moorberry-20">Russ Olsen</a><img src="https://www.assoc-amazon.com/e/ir?t=moorberry-20&l=ur2&o=1" width="1" height="1" border="0" alt="" style="border:none !important;display:inline;margin:0px !important;" />, own words</p>

<p>This is a book about making that final leap, about absorbing the Ruby programming culture, about becoming truly fluent in Ruby.</p>

<p>A formal understanding of the mechanics of Ruby isnâ€™t the same as really looking at the programming world through Ruby-colored glasses. You need to absorb the cultural part of Ruby, to see how real Rubyists use the language to solve problems.</p>

<p>This is something I have been claiming for the last few years. Learning Ruby is not difficult. To start thinking in Ruby and becoming a Rubyist is the real challenge.</p>

<h2>Structure</h2>

<p>The book is divided into 4 parts. Each part is divided into chapters. The book counts 31 chapters and about 400 pages.</p>

<ol>
<li>The Basics</li>
<li>Classes, Modules, and Blocks</li>
<li>Metaprogramming</li>
<li>Pulling It All Together</li>
</ol>


<p>The first part covers some <strong>basic Ruby features</strong> in a way you normally wonâ€™t read in any other Ruby reference. Ah, if I only had the Symbol chapter available when I started learning Ruby!</p>

<p>The second part covers <strong>Classes, Modules and Blocks</strong> and it explains how to use modules successfully, how to deal with inheritance, equality and operators. This is by far my most favorite section of the book.</p>

<p>The third part is about <strong>Metaprogramming</strong>. Whilst the name of the section is technically correct, it can be misleading. If you are looking for a complete Ruby and Metaprogramming course, check out <a href="http://www.amazon.com/gp/product/1934356476/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=1934356476&linkCode=as2&tag=moorberry-20" target="_blank">Metaprogramming Ruby: Program Like the Ruby Pros</a><img src="http://www.assoc-amazon.com/e/ir?t=moorberry-20&l=as2&o=1&a=1934356476" width="1" height="1" border="0" alt="" style="border:none !important;display:inline;margin:0px !important;" />
. This section covers common Ruby metaprogramming topic such as hooks, method_missing (a must read!) and monkey patching.</p>

<p>The fourth part wraps several topics all together and talks about <strong>creating and implementing a DSL</strong> in your Ruby applications.</p>

<p>The book ends with a <strong>rich list of references of Ruby and programming in general</strong>. The list contains amazing Ruby titles like <a href="http://www.amazon.com/gp/product/0596523009/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0596523009&linkCode=as2&tag=moorberry-20" target="_blank">Ruby Best Practices</a><img src="http://www.assoc-amazon.com/e/ir?t=moorberry-20&l=as2&o=1&a=0596523009" width="1" height="1" border="0" alt="" style="border:none !important;display:inline;margin:0px !important;" />
 or <a href="http://www.amazon.com/gp/product/0672328844/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0672328844&linkCode=as2&tag=moorberry-20" target="_blank">The Ruby Way: Solutions and Techniques in Ruby Programming</a><img src="http://www.assoc-amazon.com/e/ir?t=moorberry-20&l=as2&o=1&a=0672328844" width="1" height="1" border="0" alt="" style="border:none !important;display:inline;margin:0px !important;" />, as well programming masterpieces like <a href="http://www.amazon.com/gp/product/0070342075/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0070342075&linkCode=as2&tag=moorberry-20" target="_blank">The Elements of Programming Style</a><img src="http://www.assoc-amazon.com/e/ir?t=moorberry-20&l=as2&o=1&a=0070342075" width="1" height="1" border="0" alt="" style="border:none !important;display:inline;margin:0px !important;" />. If you&#8217;re looking for some inspiration for your next read, you&#8217;re likely to find some there.</p>

<h2>Requirements</h2>

<p>This book assumes that you have a basic knowledge of the Ruby language. You donâ€™t need to be a Ruby master, but some advanced sections such as Metaprogramming and DSL may require you to stop for a moment and refresh or improve your specific knowledge of Ruby on that topic.</p>

<p>Donâ€™t expect this book to explain the basic details of Ruby or its syntax, this is behind the scope of this publication. There are plenty of commented examples, but if you want to learn about a specific Ruby feature make sure you keep a reference like <a href="http://www.amazon.com/gp/product/1934356085/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=1934356085&linkCode=as2&tag=moorberry-20" target="_blank">Programming Ruby 1.9: The Pragmatic Programmers&#8217; Guide</a><img src="http://www.assoc-amazon.com/e/ir?t=moorberry-20&l=as2&o=1&a=1934356085" width="1" height="1" border="0" alt="" style="border:none !important;display:inline;margin:0px !important;" />
 or <a href="http://www.amazon.com/gp/product/0672328844/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0672328844&linkCode=as2&tag=moorberry-20" target="_blank">The Ruby Way: Solutions and Techniques in Ruby Programming</a><img src="http://www.assoc-amazon.com/e/ir?t=moorberry-20&l=as2&o=1&a=0672328844" width="1" height="1" border="0" alt="" style="border:none !important;display:inline;margin:0px !important;" />
 handy.</p>

<p>Another requirement is that you must be ready to read printed source code: this book is full or Ruby code. At least 50% of the pages contain code, making this book a valuable practical reference.</p>

<h2>How was it?</h2>

<p><a href="http://www.amazon.com/gp/product/0321584104/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0321584104&linkCode=as2&tag=moorberry-20" target="_blank">Eloquent Ruby</a><img src="http://www.assoc-amazon.com/e/ir?t=moorberry-20&l=as2&o=1&a=0321584104" width="1" height="1" border="0" alt="" style="border:none !important;display:inline;margin:0px !important;" /> is a very lightweight and pleasant read. The colloquial tone is friendly and engrossing. The book has plenty of code snippets and requires only a few days to read it from beginning to end.</p>

<p>Aside from being an excellent resource to help you get thinking and programming <em>the Ruby way</em>, this book constantly adopts a practical approach providing tons of examples to read. Every chapter ends with an <em>In the Wild</em> section containing examples extracted from real Ruby libraries, and a <em>Wrapping up</em> section that helps you fix the concepts in mind.</p>

<p>I appreciated the focus on tests and the RSpec chapter. Most of the code examples are verified by tests, which are also made available in the book.</p>

<p>I found the Regular Expression chapter pretty boring and misplaced. In fact, it was the only chapter in the book where the main focus was teaching Regular Expression basics, instead of focusing on using Regular Expressions within the scope of <em>the Ruby way</em>.</p>

<p>I would have left the RubyGems section out of the book. There have been several changes in the Gems community in the past couple years and the chapter appears to be slightly outdated.</p>

<p>As a side note, I would have appreciated a wider usage of Ruby 1.9 over 1.8 in order to discourage the adoption of Ruby 1.8.</p>

<h2>Who should read it?</h2>

<p>If you are a beginner to intermediate level Ruby programmer, this book is a must read that will definitely help you improve your Ruby skill, by writing code <em>the Ruby way</em>.</p>

<p>If you are completely new to Ruby, I donâ€™t recommend this book as a first reading. You might want to start with a Ruby reference to learn about programming in Ruby, then read <a href="http://www.amazon.com/gp/product/0321584104/ref=as_li_ss_tl?ie=UTF8&camp=1789&creative=390957&creativeASIN=0321584104&linkCode=as2&tag=moorberry-20" target="_blank">Eloquent Ruby</a><img src="http://www.assoc-amazon.com/e/ir?t=moorberry-20&l=as2&o=1&a=0321584104" width="1" height="1" border="0" alt="" style="border:none !important;display:inline;margin:0px !important;" /> to learn about programming <em>the Ruby way</em>.</p>

<p>If you are a Ruby expert and you have been writing Ruby for the last 5 years, donâ€™t get over-confident. Iâ€™m quite sure the book will be able to provide you some valuable advice more than once.</p>

<h3>Buy the book</h3>

<p><a href="http://www.amazon.com/gp/product/0321584104/ref=as_li_ss_il?ie=UTF8&camp=1789&creative=390957&creativeASIN=0321584104&linkCode=as2&tag=moorberry-20"><img border="0" src="http://ws.assoc-amazon.com/widgets/q?_encoding=UTF8&ASIN=0321584104&Format=_SL110_&ID=AsinImage&MarketPlace=US&ServiceVersion=20070822&WS=1&tag=moorberry-20" style="display:inline;margin:0;" /></a><img src="http://www.assoc-amazon.com/e/ir?t=moorberry-20&l=as2&o=1&a=0321584104" width="1" height="1" border="0" alt="" style="border:none !important;display:inline;margin:0px !important;" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Send Text Message Through Email]]></title>
    <link href="http://moorberry.net/blog/send-text-message-through-email/"/>
    <updated>2013-03-27T17:20:00-05:00</updated>
    <id>http://moorberry.net/blog/send-text-message-through-email</id>
    <content type="html"><![CDATA[<p>If you&#8217;d like to send a TXT message through email rather than use a SaaS application, such as <a href="http://twilio.com" target="_blank" alt="Twilio" title="Twilio">Twilio</a>, you can send SMS messages through SMTP.</p>

<!--more-->


<p>Below is a list of some common gateway email handlers to turn emails into TXTs. Just switch out the default phone number for the one you want to communicate with:</p>

<p><strong>AT&amp;T</strong><br/>
1234567890@txt.att.net</p>

<p><strong>Metro PCS</strong><br/>
1234567890@mymetropcs.com</p>

<p><strong>T-Mobile</strong><br/>
1234567890@tmomail.net</p>

<p><strong>U.S. Cellular</strong><br/>
1234567890@email.uscc.net</p>

<p><strong>Cricket Wireless</strong><br/>
1234567890@sms.mycricket.com</p>

<p><strong>Sprint</strong><br/>
1234567890@messaging.sprintpcs.com</p>

<p><strong>TracFone</strong><br/>
1234567890@mmst5.tracfone.com</p>

<p><strong>Verizon</strong><br/>
1234567890@vtext.com</p>

<p><em>If you know any handlers I haven&#8217;t included, please leave a note in the comments section below, and I&#8217;ll update the above list as soon as possible. Thanks</em></p>

<p>Some caveats to this transaction method:</p>

<ul>
<li>All mobile carriers format the message to their own liking. Some just include the sender&#8217;s email address, while other carriers will return the entire email header (which can be quite costly to small viewing areas.)</li>
<li>You&#8217;ll have to know which subscriber your target is using. But use a service like <a href="http://twilio.com" target="_blank" alt="Twilio" title="Twilio" style="color:red;">Twilio</a> and you don&#8217;t need to know how you&#8217;re sending the message &mdash; Just so long as you use a valid phone number.</li>
</ul>


<p>&nbsp;</p>

<h2>Twilio</h2>

<p><img src="http://moorberry.net/images/posts/twilio.jpg" alt="Twilio Logo" title="Twilio Logo" /></p>

<p>Try out <a href="http://twilio.com" target="_blank" alt="Twilio" title="Twilio" style="color:red;">Twilio</a>. They offer a <a href="http://twilio.com" target="_blank" alt="Twilio Free Plan" title="Twilio Free Plan" style="color:red;font-weight:bold;">free plan</a> that includes 200 messages to send each month and maintains a series of APIs that are <a href="http://www.twilio.com/blog/2012/02/adding-twilio-sms-messaging-to-your-rails-app.html" target="_blank" alt="Adding Twilio SMS Messaging to your Rails App" title="Adding Twilio SMS Messaging to your Rails App">easy to use</a> and <a href="https://github.com/twilio" target="_blank" alt="Twilio Github" title="Github Twilio">open source</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[localStorage: Object Relational Mapping]]></title>
    <link href="http://moorberry.net/blog/localstorage-object-relational-mapping/"/>
    <updated>2013-02-23T16:31:00-06:00</updated>
    <id>http://moorberry.net/blog/localstorage-object-relational-mapping</id>
    <content type="html"><![CDATA[<p>An Active Record -like localStorage Object-Relational Mapping library.</p>

<!--more-->


<p>git source: <a href="https://github.com/michaelminter/localstorage_orm" target="_blank">github.com/michaelminter/localstorage_orm</a></p>

<h2>Data</h2>

<p>Objects should be indexed by id. Example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="p">{</span><span class="s2">&quot;149&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;918497e0-29a4-012f-1aca-005056af31ef&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">108</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">269</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Light burned out&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">149</span><span class="p">},</span><span class="s2">&quot;150&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;9194e050-29a4-012f-1acb-005056af31ef&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">109</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">272</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Toilet stopped up&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">150</span><span class="p">},</span><span class="s2">&quot;151&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;919607f0-29a4-012f-1acc-005056af31ef&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">109</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">272</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Drain clogged&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">151</span><span class="p">},</span><span class="s2">&quot;152&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;91970ba0-29a4-012f-1acd-005056af31ef&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">108</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">267</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Room too cold&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">152</span><span class="p">},</span><span class="s2">&quot;153&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;919801c0-29a4-012f-1ace-005056af31ef&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">108</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">267</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Room too hot&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">153</span><span class="p">},</span><span class="s2">&quot;154&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;9198f860-29a4-012f-1acf-005056af31ef&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T21:04:05-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">109</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">283</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Door won&#39;t close&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">154</span><span class="p">},</span><span class="s2">&quot;155&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;9199e740-29a4-012f-1ad0-005056af31ef&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">108</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">269</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Power out&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">155</span><span class="p">},</span><span class="s2">&quot;156&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;919ad520-29a4-012f-1ad1-005056af31ef&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">108</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">283</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;TV is broken&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">156</span><span class="p">},</span><span class="s2">&quot;157&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;919bc420-29a4-012f-1ad2-005056af31ef&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">108</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">272</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;No hot water&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">157</span><span class="p">},</span><span class="s2">&quot;158&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;919cb3f0-29a4-012f-1ad3-005056af31ef&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">108</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">283</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;TV remote does not work&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">158</span><span class="p">},</span><span class="s2">&quot;159&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;919da3f0-29a4-012f-1ad4-005056af31ef&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">109</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">272</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Water leak&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2012-01-25T11:04:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">159</span><span class="p">},</span><span class="s2">&quot;652&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;da2dede0-3839-0130-1c8c-065142d3bcb8&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T19:13:36-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">108</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">283</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Empty cardboard bailer&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T19:13:20-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">652</span><span class="p">},</span><span class="s2">&quot;653&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;ffe96d10-3839-0130-1c90-065142d3bcb8&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T19:14:23-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">108</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">267</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Ice machine not working&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T19:14:23-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">653</span><span class="p">},</span><span class="s2">&quot;654&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;2f7b3830-383a-0130-1c99-065142d3bcb8&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T19:15:43-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">107</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">267</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Defrost refridgerator&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T19:15:43-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">654</span><span class="p">},</span><span class="s2">&quot;655&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;8fb19ba0-383a-0130-1ca0-065142d3bcb8&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T19:18:25-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">107</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">283</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Cabinet broken&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T19:18:25-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">655</span><span class="p">},</span><span class="s2">&quot;656&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;dfd7c390-3848-0130-6525-065142f28507&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T21:01:05-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">107</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">283</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Remove bed&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T21:00:52-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">656</span><span class="p">},</span><span class="s2">&quot;657&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;f5de0a10-3848-0130-652b-065142f28507&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T21:01:36-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">109</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">283</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Need bed&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T21:01:29-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">657</span><span class="p">},</span><span class="s2">&quot;658&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;2923eae0-3849-0130-6531-065142f28507&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T21:02:55-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">109</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">272</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Toilet overflowing&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T21:02:55-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">658</span><span class="p">},</span><span class="s2">&quot;659&quot;</span><span class="o">:</span><span class="p">{</span><span class="s2">&quot;patient_related&quot;</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span><span class="s2">&quot;lock_version&quot;</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="o">:</span><span class="s2">&quot;e3e490e0-3851-0130-6653-065142f28507&quot;</span><span class="p">,</span><span class="s2">&quot;updated_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T22:05:24-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;facility_id&quot;</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="s2">&quot;priority_id&quot;</span><span class="o">:</span><span class="mi">109</span><span class="p">,</span><span class="s2">&quot;job_type_id&quot;</span><span class="o">:</span><span class="mi">283</span><span class="p">,</span><span class="s2">&quot;description&quot;</span><span class="o">:</span><span class="s2">&quot;Noise&quot;</span><span class="p">,</span><span class="s2">&quot;created_at&quot;</span><span class="o">:</span><span class="s2">&quot;2013-01-03T22:05:24-06:00&quot;</span><span class="p">,</span><span class="s2">&quot;id&quot;</span><span class="o">:</span><span class="mi">659</span><span class="p">}}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Ruby Tip</h3>

<p>You can index by a hash by each record&#8217;s unique ID using the Rails Enumerable method: <a href="http://apidock.com/rails/Enumerable/index_by" target="_blank">index_by</a>.</p>

<blockquote><p>Convert an enumerable to a hash.</p></blockquote>

<h3>Example</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Workorder</span><span class="p">.</span><span class="nx">all</span><span class="p">.</span><span class="nx">index_by</span><span class="p">(</span><span class="o">&amp;:</span><span class="nx">id</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Constructor</h2>

<p>Initialize a new model class. If no localStorage table (key) is available one is created when the below code is parsed:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">Workorder</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Model</span><span class="p">(</span><span class="s1">&#39;workorders&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Find</h2>

<p>The following will return the referenced object that belongs to its associated ID:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Workorder</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="mi">101</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Where</h2>

<p>The following will return all workorders <em>where</em> the created_at date is less than the decalred <em>date</em> variable.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">date</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
</span><span class='line'><span class="nx">Workorder</span><span class="p">.</span><span class="nx">where</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="s2">&quot;MichaelMinter&quot;</span><span class="p">,</span><span class="nx">age</span><span class="o">:</span><span class="mi">28</span><span class="p">,</span><span class="nx">created_at</span><span class="o">:</span><span class="nx">date</span><span class="p">,</span><span class="nx">admin</span><span class="o">:</span><span class="kc">true</span><span class="p">},{</span><span class="nx">created_at</span><span class="o">:</span><span class="s1">&#39;&lt;&#39;</span><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Variable Types</h3>

<ul>
<li><strong>String</strong> utilizes Regex. Because the lookups are an object you <em>cannot</em> use something like: <code>{description:"a",description:"b"}</code> but you <em>can</em> do <code>{description:"[a-b]"}</code></li>
<li><strong>Numbers</strong> will only search literal integeral values. A variable string type, &#8220;1&#8221; is not the same as the variable number type, 1.</li>
<li><strong>Object</strong> is exclusive to dates and an option object <code>{due_date:"&gt;"}</code> is required to evaluaute references.</li>
<li><strong>Boolean</strong> will only search literal boolean values. So <code>{notifications:true}</code> is <em>not</em> the same as <code>{notifications:"true"}</code>.</li>
<li><strong>Null</strong> will return any empty, or <em>null</em>, values. <code>null</code> is not the same as <code>""</code>.</li>
</ul>


<h2>More</h2>

<p>Extends <strong>Storage</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">Storage</span><span class="p">){</span>
</span><span class='line'>  <span class="nx">Storage</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setObject</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">value</span><span class="p">));</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">Storage</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getObject</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">value</span> <span class="o">&amp;&amp;</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;localStorage is not supported on this browser&#39;</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>git source: <a href="https://github.com/michaelminter/localstorage_orm" target="_blank">github.com/michaelminter/localstorage_orm</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Airbrake: Send Error Notices using Javascript]]></title>
    <link href="http://moorberry.net/blog/airbrake-error-notice-javascript/"/>
    <updated>2013-02-19T12:46:00-06:00</updated>
    <id>http://moorberry.net/blog/airbrake-error-notice-javascript</id>
    <content type="html"><![CDATA[<p>Right now you may be saying to yourself, &#8220;but why not just use an AJAX request inside of my Javascript application or use the Image().src hack&#8230;&#8221;</p>

<!--more-->


<p>Well they don&#8217;t work across all medias.</p>

<p>You cannot issue requests through the XMLHttpRequest to other domains or subdomains. If you are issuing the request from www.foo.com you also need to target the request at www.foo.com and make certain to remember the www.</p>

<p>If you really need to hit another domain you can use <a href="http://en.wikipedia.org/wiki/JSONP" target="_blank">JsonP</a> where the browser utilizes the <code>&lt;script&gt;</code> tags ability to load scripts from a different domain. The loaded script then executes a callback function to give you the data. But for regular AJAX calls you cannot leave the source domain at all.</p>

<p>See the Wiki article on <a href="http://en.wikipedia.org/wiki/Same_origin_policy" target="_blank">Same Origin Policy</a></p>

<p>In your Rails/Sinatra application controller file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">notice</span> <span class="o">=</span> <span class="nx">params</span><span class="p">[</span><span class="o">:</span><span class="nx">notice</span><span class="p">]</span>
</span><span class='line'><span class="nx">url</span>    <span class="o">=</span> <span class="nx">URI</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;http://api.airbrake.io/notifier_api/v2/notices&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nx">request</span>              <span class="o">=</span> <span class="nx">Net</span><span class="o">::</span><span class="nx">HTTP</span><span class="o">::</span><span class="nx">Post</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span>
</span><span class='line'><span class="nx">request</span><span class="p">.</span><span class="nx">content_type</span> <span class="o">=</span> <span class="s1">&#39;text/xml&#39;</span>
</span><span class='line'><span class="nx">request</span><span class="p">.</span><span class="nx">body</span>         <span class="o">=</span> <span class="s2">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;</span>
</span><span class='line'><span class="s2">                      &lt;notice version=\&quot;2.3\&quot;&gt;</span>
</span><span class='line'><span class="s2">                        &lt;api-key&gt;948fhc4h9f98f190a4d69fee945d8b133cc11&lt;/api-key&gt;</span>
</span><span class='line'><span class="s2">                        &lt;notifier&gt;</span>
</span><span class='line'><span class="s2">                          &lt;name&gt;Airbrake Notifier&lt;/name&gt;</span>
</span><span class='line'><span class="s2">                          &lt;version&gt;3.1.6&lt;/version&gt;</span>
</span><span class='line'><span class="s2">                          &lt;url&gt;http://api.airbrake.io&lt;/url&gt;</span>
</span><span class='line'><span class="s2">                        &lt;/notifier&gt;</span>
</span><span class='line'><span class="s2">                        &lt;error&gt;</span>
</span><span class='line'><span class="s2">                          &lt;class&gt;RuntimeError&lt;/class&gt;</span>
</span><span class='line'><span class="s2">                          &lt;message&gt;#{notice}&lt;/message&gt;</span>
</span><span class='line'><span class="s2">                          &lt;backtrace&gt;</span>
</span><span class='line'><span class="s2">                            &lt;line method=\&quot;public\&quot; file=\&quot;/testapp/app/models/user.rb\&quot; number=\&quot;53\&quot;/&gt;</span>
</span><span class='line'><span class="s2">                            &lt;line method=\&quot;index\&quot; file=\&quot;/testapp/app/controllers/users_controller.rb\&quot; number=\&quot;14\&quot;/&gt;</span>
</span><span class='line'><span class="s2">                          &lt;/backtrace&gt;</span>
</span><span class='line'><span class="s2">                        &lt;/error&gt;</span>
</span><span class='line'><span class="s2">                        &lt;request&gt;</span>
</span><span class='line'><span class="s2">                          &lt;url&gt;#{request.url}&lt;/url&gt;</span>
</span><span class='line'><span class="s2">                          &lt;component/&gt;</span>
</span><span class='line'><span class="s2">                          &lt;action/&gt;</span>
</span><span class='line'><span class="s2">                          &lt;cgi-data&gt;</span>
</span><span class='line'><span class="s2">                            &lt;var key=\&quot;SERVER_NAME\&quot;&gt;example.org&lt;/var&gt;</span>
</span><span class='line'><span class="s2">                            &lt;var key=\&quot;HTTP_USER_AGENT\&quot;&gt;Mozilla&lt;/var&gt;</span>
</span><span class='line'><span class="s2">                          &lt;/cgi-data&gt;</span>
</span><span class='line'><span class="s2">                        &lt;/request&gt;</span>
</span><span class='line'><span class="s2">                        &lt;server-environment&gt;</span>
</span><span class='line'><span class="s2">                          &lt;project-root&gt;/testapp&lt;/project-root&gt;</span>
</span><span class='line'><span class="s2">                          &lt;environment-name&gt;production&lt;/environment-name&gt;</span>
</span><span class='line'><span class="s2">                          &lt;app-version&gt;1.0.0&lt;/app-version&gt;</span>
</span><span class='line'><span class="s2">                        &lt;/server-environment&gt;</span>
</span><span class='line'><span class="s2">                      &lt;/notice&gt;&quot;</span>
</span><span class='line'><span class="nx">response</span> <span class="o">=</span> <span class="nx">Net</span><span class="o">::</span><span class="nx">HTTP</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nx">host</span><span class="p">,</span> <span class="nx">url</span><span class="p">.</span><span class="nx">port</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="nx">http</span><span class="o">|</span> <span class="nx">http</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">request</span><span class="p">)}</span>
</span></code></pre></td></tr></table></div></figure>


<p>In your javascript:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">airbrake</span><span class="p">(</span><span class="nx">notice</span><span class="p">){</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">airbrake</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span> <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;/api/v1/error&#39;</span><span class="p">,</span> <span class="nx">context</span><span class="o">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span> <span class="nx">cache</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="o">:</span> <span class="p">{</span> <span class="nx">notice</span><span class="o">:</span> <span class="nx">notice</span> <span class="p">}</span> <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>To call this function, simply:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">airbrake</span> <span class="p">(</span><span class="s2">&quot;This goose won&#39;t cook.&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Some alternative error/message handlers include: <a href="http://loggly.com" target="_blank">Loggly</a>, <a href="https://papertrailapp.com/" target="_blank">Papertrail</a>, <a href="https://logentries.com/" target="_blank">Log Entries</a>, or better yet create your own with <a href="https://github.com/flyingmachine/whoops" target="_blank">Whoops</a> which later I&#8217;d like to research and develop upon for my own error catching application.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[DataTables Pagination with Twitter Bootstrap]]></title>
    <link href="http://moorberry.net/blog/datatables-twitter-bootstrap-pagination/"/>
    <updated>2013-02-11T14:34:00-06:00</updated>
    <id>http://moorberry.net/blog/datatables-twitter-bootstrap-pagination</id>
    <content type="html"><![CDATA[<p>As a developer who likes to spend more time with beautiful object-oriented code rather than mark-up, <a href="http://datatables.net" target="_blank">DataTables</a> is a wonderful tool for me, with a growing list of extendable features.</p>

<!--more-->


<blockquote><p>DataTables operates on the principle of progressive enhancement, whereby an enhanced and interactive table will be presented to the end user if their browser has the required capabilities.</p></blockquote>

<p>One <a href="http://datatables.net/plug-ins/pagination" target="_blank">plug-in</a> that I found will allow your browser to render the default pagination with tags that are designed to work with the popular responsive grid framework: <a href="http://twitter.github.com/bootstrap" target="_blank">Twitter Bootstrap</a>.</p>

<p><img src="http://moorberry.net/images/posts/pagination.jpg" alt="DataTables Pagination with Twitter Bootstrap Design Inteegration" width="100%" /></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c">&lt;!--</span> <span class="nx">more</span> <span class="nx">information</span> <span class="nx">at</span><span class="o">:</span> <span class="nx">http</span><span class="o">:</span><span class="c1">//www.datatables.net/download/ --&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.9.1.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.4/jquery.dataTables.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="cm">/* API method to get paging information */</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">dataTableExt</span><span class="p">.</span><span class="nx">oApi</span><span class="p">.</span><span class="nx">fnPagingInfo</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">oSettings</span> <span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="p">{</span>
</span><span class='line'>          <span class="s2">&quot;iStart&quot;</span><span class="o">:</span>         <span class="nx">oSettings</span><span class="p">.</span><span class="nx">_iDisplayStart</span><span class="p">,</span>
</span><span class='line'>          <span class="s2">&quot;iEnd&quot;</span><span class="o">:</span>           <span class="nx">oSettings</span><span class="p">.</span><span class="nx">fnDisplayEnd</span><span class="p">(),</span>
</span><span class='line'>          <span class="s2">&quot;iLength&quot;</span><span class="o">:</span>        <span class="nx">oSettings</span><span class="p">.</span><span class="nx">_iDisplayLength</span><span class="p">,</span>
</span><span class='line'>          <span class="s2">&quot;iTotal&quot;</span><span class="o">:</span>         <span class="nx">oSettings</span><span class="p">.</span><span class="nx">fnRecordsTotal</span><span class="p">(),</span>
</span><span class='line'>          <span class="s2">&quot;iFilteredTotal&quot;</span><span class="o">:</span> <span class="nx">oSettings</span><span class="p">.</span><span class="nx">fnRecordsDisplay</span><span class="p">(),</span>
</span><span class='line'>          <span class="s2">&quot;iPage&quot;</span><span class="o">:</span>          <span class="nx">oSettings</span><span class="p">.</span><span class="nx">_iDisplayLength</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">?</span>
</span><span class='line'>              <span class="mi">0</span> <span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span> <span class="nx">oSettings</span><span class="p">.</span><span class="nx">_iDisplayStart</span> <span class="o">/</span> <span class="nx">oSettings</span><span class="p">.</span><span class="nx">_iDisplayLength</span> <span class="p">),</span>
</span><span class='line'>          <span class="s2">&quot;iTotalPages&quot;</span><span class="o">:</span>    <span class="nx">oSettings</span><span class="p">.</span><span class="nx">_iDisplayLength</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">?</span>
</span><span class='line'>              <span class="mi">0</span> <span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span> <span class="nx">oSettings</span><span class="p">.</span><span class="nx">fnRecordsDisplay</span><span class="p">()</span> <span class="o">/</span> <span class="nx">oSettings</span><span class="p">.</span><span class="nx">_iDisplayLength</span> <span class="p">)</span>
</span><span class='line'>      <span class="p">};</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="cm">/* Bootstrap style pagination control */</span>
</span><span class='line'>  <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span> <span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">dataTableExt</span><span class="p">.</span><span class="nx">oPagination</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>      <span class="s2">&quot;bootstrap&quot;</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>          <span class="s2">&quot;fnInit&quot;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">oSettings</span><span class="p">,</span> <span class="nx">nPaging</span><span class="p">,</span> <span class="nx">fnDraw</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">oLang</span> <span class="o">=</span> <span class="nx">oSettings</span><span class="p">.</span><span class="nx">oLanguage</span><span class="p">.</span><span class="nx">oPaginate</span><span class="p">;</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">fnClickHandler</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">e</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>                  <span class="k">if</span> <span class="p">(</span> <span class="nx">oSettings</span><span class="p">.</span><span class="nx">oApi</span><span class="p">.</span><span class="nx">_fnPageChange</span><span class="p">(</span><span class="nx">oSettings</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">action</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                      <span class="nx">fnDraw</span><span class="p">(</span> <span class="nx">oSettings</span> <span class="p">);</span>
</span><span class='line'>                  <span class="p">}</span>
</span><span class='line'>              <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>              <span class="nx">$</span><span class="p">(</span><span class="nx">nPaging</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;pagination&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span>
</span><span class='line'>                  <span class="s1">&#39;&lt;ul&gt;&#39;</span><span class="o">+</span>
</span><span class='line'>                      <span class="s1">&#39;&lt;li class=&quot;prev disabled&quot;&gt;&lt;a href=&quot;#&quot;&gt;&amp;larr; &#39;</span><span class="o">+</span><span class="nx">oLang</span><span class="p">.</span><span class="nx">sPrevious</span><span class="o">+</span><span class="s1">&#39;&lt;/a&gt;&lt;/li&gt;&#39;</span><span class="o">+</span>
</span><span class='line'>                      <span class="s1">&#39;&lt;li class=&quot;next disabled&quot;&gt;&lt;a href=&quot;#&quot;&gt;&#39;</span><span class="o">+</span><span class="nx">oLang</span><span class="p">.</span><span class="nx">sNext</span><span class="o">+</span><span class="s1">&#39; &amp;rarr; &lt;/a&gt;&lt;/li&gt;&#39;</span><span class="o">+</span>
</span><span class='line'>                  <span class="s1">&#39;&lt;/ul&gt;&#39;</span>
</span><span class='line'>              <span class="p">);</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">els</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="nx">nPaging</span><span class="p">);</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">(</span><span class="nx">els</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">bind</span><span class="p">(</span> <span class="s1">&#39;click.DT&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">action</span><span class="o">:</span> <span class="s2">&quot;previous&quot;</span> <span class="p">},</span> <span class="nx">fnClickHandler</span> <span class="p">);</span>
</span><span class='line'>              <span class="nx">$</span><span class="p">(</span><span class="nx">els</span><span class="p">[</span><span class="mi">1</span><span class="p">]).</span><span class="nx">bind</span><span class="p">(</span> <span class="s1">&#39;click.DT&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">action</span><span class="o">:</span> <span class="s2">&quot;next&quot;</span> <span class="p">},</span> <span class="nx">fnClickHandler</span> <span class="p">);</span>
</span><span class='line'>          <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>          <span class="s2">&quot;fnUpdate&quot;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">oSettings</span><span class="p">,</span> <span class="nx">fnDraw</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">iListLength</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">oPaging</span> <span class="o">=</span> <span class="nx">oSettings</span><span class="p">.</span><span class="nx">oInstance</span><span class="p">.</span><span class="nx">fnPagingInfo</span><span class="p">();</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">an</span> <span class="o">=</span> <span class="nx">oSettings</span><span class="p">.</span><span class="nx">aanFeatures</span><span class="p">.</span><span class="nx">p</span><span class="p">;</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">sClass</span><span class="p">,</span> <span class="nx">iStart</span><span class="p">,</span> <span class="nx">iEnd</span><span class="p">,</span> <span class="nx">iHalf</span><span class="o">=</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">iListLength</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>              <span class="k">if</span> <span class="p">(</span> <span class="nx">oPaging</span><span class="p">.</span><span class="nx">iTotalPages</span> <span class="o">&lt;</span> <span class="nx">iListLength</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">iStart</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>                  <span class="nx">iEnd</span> <span class="o">=</span> <span class="nx">oPaging</span><span class="p">.</span><span class="nx">iTotalPages</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>              <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">oPaging</span><span class="p">.</span><span class="nx">iPage</span> <span class="o">&lt;=</span> <span class="nx">iHalf</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">iStart</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>                  <span class="nx">iEnd</span> <span class="o">=</span> <span class="nx">iListLength</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="nx">oPaging</span><span class="p">.</span><span class="nx">iPage</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="nx">oPaging</span><span class="p">.</span><span class="nx">iTotalPages</span><span class="o">-</span><span class="nx">iHalf</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">iStart</span> <span class="o">=</span> <span class="nx">oPaging</span><span class="p">.</span><span class="nx">iTotalPages</span> <span class="o">-</span> <span class="nx">iListLength</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>                  <span class="nx">iEnd</span> <span class="o">=</span> <span class="nx">oPaging</span><span class="p">.</span><span class="nx">iTotalPages</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                  <span class="nx">iStart</span> <span class="o">=</span> <span class="nx">oPaging</span><span class="p">.</span><span class="nx">iPage</span> <span class="o">-</span> <span class="nx">iHalf</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>                  <span class="nx">iEnd</span> <span class="o">=</span> <span class="nx">iStart</span> <span class="o">+</span> <span class="nx">iListLength</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>              <span class="k">for</span> <span class="p">(</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">iLen</span><span class="o">=</span><span class="nx">an</span><span class="p">.</span><span class="nx">length</span> <span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="nx">iLen</span> <span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                  <span class="c1">// Remove the middle elements</span>
</span><span class='line'>                  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;li:gt(0)&#39;</span><span class="p">,</span> <span class="nx">an</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">filter</span><span class="p">(</span><span class="s1">&#39;:not(:last)&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>                  <span class="c1">// Add the new list items and their event handlers</span>
</span><span class='line'>                  <span class="k">for</span> <span class="p">(</span> <span class="nx">j</span><span class="o">=</span><span class="nx">iStart</span> <span class="p">;</span> <span class="nx">j</span><span class="o">&lt;=</span><span class="nx">iEnd</span> <span class="p">;</span> <span class="nx">j</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                      <span class="nx">sClass</span> <span class="o">=</span> <span class="p">(</span><span class="nx">j</span><span class="o">==</span><span class="nx">oPaging</span><span class="p">.</span><span class="nx">iPage</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;class=&quot;active&quot;&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>                      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;li &#39;</span><span class="o">+</span><span class="nx">sClass</span><span class="o">+</span><span class="s1">&#39;&gt;&lt;a href=&quot;#&quot;&gt;&#39;</span><span class="o">+</span><span class="nx">j</span><span class="o">+</span><span class="s1">&#39;&lt;/a&gt;&lt;/li&gt;&#39;</span><span class="p">)</span>
</span><span class='line'>                          <span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;li:last&#39;</span><span class="p">,</span> <span class="nx">an</span><span class="p">[</span><span class="nx">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
</span><span class='line'>                          <span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                              <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
</span><span class='line'>                              <span class="nx">oSettings</span><span class="p">.</span><span class="nx">_iDisplayStart</span> <span class="o">=</span> <span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">).</span><span class="nx">text</span><span class="p">(),</span><span class="mi">10</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nx">oPaging</span><span class="p">.</span><span class="nx">iLength</span><span class="p">;</span>
</span><span class='line'>                              <span class="nx">fnDraw</span><span class="p">(</span> <span class="nx">oSettings</span> <span class="p">);</span>
</span><span class='line'>                          <span class="p">}</span> <span class="p">);</span>
</span><span class='line'>                  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>                  <span class="c1">// Add / remove disabled classes from the static elements</span>
</span><span class='line'>                  <span class="k">if</span> <span class="p">(</span> <span class="nx">oPaging</span><span class="p">.</span><span class="nx">iPage</span> <span class="o">===</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;li:first&#39;</span><span class="p">,</span> <span class="nx">an</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;disabled&#39;</span><span class="p">);</span>
</span><span class='line'>                  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;li:first&#39;</span><span class="p">,</span> <span class="nx">an</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;disabled&#39;</span><span class="p">);</span>
</span><span class='line'>                  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>                  <span class="k">if</span> <span class="p">(</span> <span class="nx">oPaging</span><span class="p">.</span><span class="nx">iPage</span> <span class="o">===</span> <span class="nx">oPaging</span><span class="p">.</span><span class="nx">iTotalPages</span><span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="nx">oPaging</span><span class="p">.</span><span class="nx">iTotalPages</span> <span class="o">===</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;li:last&#39;</span><span class="p">,</span> <span class="nx">an</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;disabled&#39;</span><span class="p">);</span>
</span><span class='line'>                  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;li:last&#39;</span><span class="p">,</span> <span class="nx">an</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s1">&#39;disabled&#39;</span><span class="p">);</span>
</span><span class='line'>                  <span class="p">}</span>
</span><span class='line'>              <span class="p">}</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span> <span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">oTable</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.data-table&#39;</span><span class="p">).</span><span class="nx">dataTable</span><span class="p">({</span>
</span><span class='line'>    <span class="s2">&quot;iDisplayStart&quot;</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
</span><span class='line'>    <span class="s2">&quot;aLengthMenu&quot;</span><span class="o">:</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;All&#39;</span><span class="p">]],</span>
</span><span class='line'>    <span class="s2">&quot;sPaginationType&quot;</span><span class="o">:</span> <span class="s2">&quot;bootstrap&quot;</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, just set up your table with a class of <strong>data-table</strong> and you&#8217;ll have a paginated controller that comfortably fits the rest of the application&#8217;s design flow.</p>

<p>DataTables, is an open source project. You can fork its code <a href="https://github.com/DataTables/DataTables" target="_blank">by clicking here</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Clicked Link Attributes in jQuery Mobile Events]]></title>
    <link href="http://moorberry.net/blog/link-attributes-jquery-mobile/"/>
    <updated>2013-02-06T18:13:00-06:00</updated>
    <id>http://moorberry.net/blog/link-attributes-jquery-mobile</id>
    <content type="html"><![CDATA[<p>So&#8230;are you tired of writing and rewriting (or commenting out) Javascript and want to handle your clicked link attributes inside of a <a href="http://jquerymobile.com/" target="_blank">jQuery Mobile</a> event? Here&#8217;s how:</p>

<!--more-->




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="n">var</span> <span class="n">params</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class='line'>
</span><span class='line'><span class="vg">$(</span><span class="s">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">live</span><span class="p">(</span><span class="s">&#39;click&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="nv">$</span><span class="err">.</span><span class="nv">each</span><span class="p">(</span><span class="nv">$</span><span class="err">(</span><span class="nv">event</span><span class="o">.</span><span class="n">target</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">attributes</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">){</span>
</span><span class='line'>    <span class="n">params</span><span class="p">[</span><span class="n">value</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span><span class="p">;</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="vg">$(</span><span class="s">&#39;div[data-role=&quot;page&quot;]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">live</span><span class="p">(</span><span class="s">&#39;pageshow&#39;</span><span class="p">,</span><span class="n">function</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">ui</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'> <span class="n">console</span><span class="o">.</span><span class="nb">log</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>The click event has to be done separately and parsed before the <em>pageshow</em> event takes place.</p>

<p>Doing things this way you can also take full advantage of the rest of jQuery Mobile&#8217;s special page responsive <a href="http://jquerymobile.com/test/docs/api/events.html" target="_blank">events</a> that happen throughtout the life of your application.</p>

<p>Please, if you have any ideas for an alternative method of injecting clicked link attributes into event functions, comment below.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Special Notes Lookup in Rails]]></title>
    <link href="http://moorberry.net/blog/notes/"/>
    <updated>2012-11-06T17:52:00-06:00</updated>
    <id>http://moorberry.net/blog/notes</id>
    <content type="html"><![CDATA[<p>Add special notes to your source code comments in Rails to later remind you of tasks you need to complete:</p>

<!--more-->




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="n">class</span> <span class="n">Article</span> <span class="o">&lt;</span> <span class="nn">ActiveRecord::</span><span class="n">Base</span>
</span><span class='line'>  <span class="c1"># TODO add named_scopes</span>
</span><span class='line'>  <span class="c1"># FIXME method A is broken</span>
</span><span class='line'>  <span class="c1"># OPTIMIZE improve the code </span>
</span><span class='line'>  
</span><span class='line'>  <span class="n">has_many</span> <span class="p">:</span><span class="n">comments</span>
</span><span class='line'>  <span class="o">....</span>
</span><span class='line'><span class="n">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Some programming IDEs, such as <a href="http://www.aptana.com/" target="_blank">Aptana Studio 3</a> (free), will even highlight the key notation part.</p>

<p>Now, from the command line, you can list these special notes with a rake task:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>$ rake notes
</span><span class='line'>app/models/article.rb:
</span><span class='line'>  * [2] [TODO] add named_scopes
</span><span class='line'>  * [3] [FIXME] method A is broken
</span><span class='line'>  * [4] [OPTIMIZE] improve the code
</span></code></pre></td></tr></table></div></figure>


<p>You can also list notes of each kind individually with <code>rake notes:todo</code>, <code>rake notes:fixme</code> and <code>rake notes:optimize</code>.</p>

<p>You can even list your own, custom notes with <code>rake notes:custom ANNOTATION=MYANNO</code>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Keeping Your Heroku Dyno Awake]]></title>
    <link href="http://moorberry.net/blog/heroku-dyno-ping/"/>
    <updated>2012-09-20T16:23:00-05:00</updated>
    <id>http://moorberry.net/blog/heroku-dyno-ping</id>
    <content type="html"><![CDATA[<p>Apps that have scaled the number of web dynos (dynos running the web process type) so that only a single web dyno is running, will have that web dyno idled out after one hour of inactivity. When this happens, youâ€™ll see the following in your logs:</p>

<!--more-->


<pre><code>2011-05-30T19:11:09+00:00 heroku[web.1]: Idling
2011-05-30T19:11:17+00:00 heroku[web.1]: Stopping process with SIGTERM
</code></pre>

<p>When you access the app in your web browser or by some other means of sending an HTTP request, the routing mesh will signal the dyno manifold to unidle (or &#8220;wake up&#8221;) your dyno to run the web process type:</p>

<pre><code>2011-05-30T22:17:43+00:00 heroku[web.1]: Unidling
2011-05-30T22:17:43+00:00 heroku[web.1]: State changed from created to starting
</code></pre>

<p>This causes a few second delay for this first request. Subsequent requests will perform normally.</p>

<p><em>Apps that have more than 1 web dyno running are never idled out. Workers dynos are never idled out.</em></p>

<h2>The Good News</h2>

<p>Overcome this nuisance by touching the site at least every hour so that the dyno doesn&#8217;t have time to begin idling.</p>

<p><img src="http://moorberry.net/images/posts/console_ping.png" alt="console preview" style="width:100%;" /></p>

<p>You can sign up for a service provider, <strong>free</strong> at <a href="http://pingdom.com" target="_blank" style="font-weight:bold;">Pingdom</a>, that will ping your application at designated intervals.</p>

<p><strong>Ping</strong> is a network protocol that sends ICMP <em>echo request</em> packets to the target host and waits for a response.</p>

<p><a href="http://pingdom.com" target="_blank"><img src="http://moorberry.net/images/posts/pingdom_dashboard.png" alt="Pingdom" style="width:100%;" /></a></p>

<p><a href="http://pingdom.com" target="_blank" style="font-weight:bold;">Pingdom</a> is loaded with features; including availability to a public page to view when the last time your host was checked, alerts via email or SMS, and many other features.</p>

<p><a href="http://pingdom.com" target="_blank"><img src="http://moorberry.net/images/posts/pingdom_public.png" style="border:none;" alt="Pingdom" style="width:100%;" /></a></p>

<p>I chose to sample <a href="http://pingdom.com" target="_blank" style="font-weight:bold;">Pingdom</a> because it affords the least amount of work in setting up at a free price. Please post any alternatives you can think of in the comments below.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Activate Java Console in Mac]]></title>
    <link href="http://moorberry.net/blog/java-console-mac/"/>
    <updated>2012-09-10T10:41:00-05:00</updated>
    <id>http://moorberry.net/blog/java-console-mac</id>
    <content type="html"><![CDATA[<p>When you need to debug a Java applet running on your website, there&#8217;s only one way, and that&#8217;s with Mac&#8217;s built-in Java console.</p>

<!--more-->


<p>Because Adobe DWF files are based on proprietory software, there&#8217;s not a lot of documentation on working with them, and even less if you want to render them in your own product.</p>

<p>I was fortunate enough to come across a Java Applet by <a href="http://cadviewer.com" target="_blank">CADViewer</a>. They&#8217;re support is awesome and their product&#8217;s API is superior to any others I&#8217;ve seen available. They&#8217;ll even work with you on a price to fit your circumstance.</p>

<p>But to debug any Java Applet in your Mac OS, do this:</p>

<pre><code>Applications &gt; Utilities &gt; Java Console
</code></pre>

<p><a href="http://moorberry.net/images/posts/java-console.png"><img src="http://moorberry.net/images/posts/java-console.png" alit="Java Console in Mac OS X 10.8" width="100%" /></a></p>

<p>Click the <code>Show console</code> radio button and select any other options you&#8217;d like to show up while the Java console is running.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[HTML Not Rendering in Gmail]]></title>
    <link href="http://moorberry.net/blog/html-not-rendering-in-gmail/"/>
    <updated>2011-12-10T12:52:00-06:00</updated>
    <id>http://moorberry.net/blog/html-not-rendering-in-gmail</id>
    <content type="html"><![CDATA[<p>Iâ€™ve been handling many of my companyâ€™s email campaigns for some time now and I can honestly say that itâ€™s been pretty fun from a technical stand-point. Thereâ€™s a lot that goes into email marketing (not including the marketing/sales implications). It has itâ€™s own conventions, ideologies, and I believe to the utmost that thereâ€™s a larger future than presumed in store for the sometimes misunderstood technology. (Iâ€™m patiently waiting for a mobile device header-type.)</p>

<!--more-->


<p><img src="http://moorberry.net/images/posts/sendgrid-banner.jpeg" title="SendGrid" alt="SendGrid" style="width:100%;" /></p>

<p>Recently Iâ€™ve been using my new skills while working on my own applications using <a href="http://sendgrid.tellapal.com/a/clk/1zzx0" title="SendGrid">SendGrid</a> as an alternative SMTP and email analytics tool. And Iâ€™ve only really come across one major programmable error. If you use a desktop client instead of a browser for viewing emails, as I do oftentimes, then this issue might not be so apparent (till now).</p>

<p>I recently was witness to how Gmail handles email headers in regards to HTML v. text-only. Gmailâ€™s SaaS actually only reads the latter MIME-type and throws away the rest. So if you have a text version being made available, and you want your emails to be seen strictly as HTML, you must render the HTML version in your code LAST. Here is a Ruby on Rails example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Notifier</span> <span class="o">&lt;</span> <span class="no">ActionMailer</span><span class="o">::</span><span class="no">Base</span>
</span><span class='line'>  <span class="kp">include</span> <span class="no">SendGrid</span>
</span><span class='line'>  <span class="n">default</span> <span class="ss">:from</span> <span class="o">=&gt;</span> <span class="no">Rails</span><span class="o">.</span><span class="n">configuration</span><span class="o">.</span><span class="n">sendgrid</span><span class="o">.</span><span class="n">reply_to</span>
</span><span class='line'>  <span class="n">sendgrid_enable</span> <span class="ss">:opentrack</span><span class="p">,</span> <span class="ss">:clicktrack</span><span class="p">,</span> <span class="ss">:ganalytics</span>
</span><span class='line'>  <span class="n">sendgrid_category</span> <span class="ss">:testing</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">user_updated</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@user</span> <span class="o">=</span> <span class="n">user</span>
</span><span class='line'>    <span class="n">mail</span><span class="p">(</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="vi">@user</span><span class="o">.</span><span class="n">email</span><span class="p">,</span>
</span><span class='line'>          <span class="ss">:subject</span> <span class="o">=&gt;</span> <span class="s2">&quot;Your information has been updated.&quot;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>      <span class="nb">format</span><span class="o">.</span><span class="n">text</span> <span class="p">{</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">user</span><span class="o">.</span><span class="n">first_name</span><span class="si">}</span><span class="s2">,</span><span class="se">\n\n</span><span class="s2">This is an auto-response to inform you that your information has changed.&quot;</span> <span class="p">}</span>
</span><span class='line'>      <span class="nb">format</span><span class="o">.</span><span class="n">html</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">:layout</span> <span class="o">=&gt;</span> <span class="s1">&#39;autoresponse&#39;</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Super â€œthanksâ€ go out to the <a href="http://sendgrid.tellapal.com/a/clk/1zzx0" title="SendGrid">SendGrid</a> crew for their constantly superior customer service skills and for helping me out on my way to becoming an email marketing specialist.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Export Data as CSV]]></title>
    <link href="http://moorberry.net/blog/export-csv/"/>
    <updated>2011-11-14T15:15:00-06:00</updated>
    <id>http://moorberry.net/blog/export-csv</id>
    <content type="html"><![CDATA[<p>In my research I found a hundred and more different ways to manage the task of exporting data into a CSV file. Whenever Iâ€™m learning something new, on a new system or with a new language, I like to build the process myself from scratch. And being a minimalist programmer it just seems fitting. Enjoy</p>

<!--more-->




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">export_inverts</span>
</span><span class='line'>  <span class="nb">require</span> <span class="s1">&#39;fastercsv&#39;</span>
</span><span class='line'>  <span class="n">inverts</span>  <span class="o">=</span> <span class="no">Invert</span><span class="o">.</span><span class="n">all</span>
</span><span class='line'>  <span class="n">filename</span> <span class="o">=</span> <span class="n">params</span><span class="o">[</span><span class="ss">:action</span><span class="o">]</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">#this is required if you want this to work with IE</span>
</span><span class='line'>  <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">env</span><span class="o">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="o">]</span> <span class="o">=~</span> <span class="sr">/msie/i</span>
</span><span class='line'>    <span class="n">headers</span><span class="o">[</span><span class="s1">&#39;Pragma&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s1">&#39;public&#39;</span>
</span><span class='line'>    <span class="n">headers</span><span class="o">[</span><span class="s2">&quot;Content-type&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;text/plain&quot;</span>
</span><span class='line'>    <span class="n">headers</span><span class="o">[</span><span class="s1">&#39;Cache-Control&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s1">&#39;no-cache, must-revalidate, post-check=0, pre-check=0&#39;</span>
</span><span class='line'>    <span class="n">headers</span><span class="o">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;attachment; filename=</span><span class="se">\&quot;</span><span class="si">#{</span><span class="n">filename</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="n">headers</span><span class="o">[</span><span class="s1">&#39;Expires&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    <span class="n">headers</span><span class="o">[</span><span class="s2">&quot;Content-Type&quot;</span><span class="o">]</span> <span class="o">||=</span> <span class="s1">&#39;text/csv&#39;</span>
</span><span class='line'>    <span class="n">headers</span><span class="o">[</span><span class="s2">&quot;Content-Disposition&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;attachment; filename=</span><span class="se">\&quot;</span><span class="si">#{</span><span class="n">filename</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="n">headers</span><span class="o">[</span><span class="s2">&quot;Content-Transfer-Encoding&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;binary&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">csv_string</span> <span class="o">=</span> <span class="no">FasterCSV</span><span class="o">.</span><span class="n">generate</span> <span class="k">do</span> <span class="o">|</span><span class="n">csv</span><span class="o">|</span>
</span><span class='line'>    <span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="o">[</span><span class="s2">&quot;Genus&quot;</span><span class="p">,</span><span class="s2">&quot;Species&quot;</span><span class="p">,</span><span class="s2">&quot;Common Name&quot;</span><span class="p">,</span><span class="s2">&quot;Pet Name&quot;</span><span class="p">,</span><span class="s2">&quot;Gender&quot;</span><span class="o">]</span>
</span><span class='line'>    <span class="n">inverts</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
</span><span class='line'>      <span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="o">[</span><span class="n">i</span><span class="o">.</span><span class="n">scientific_name</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">scientific_name</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">common_name</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">pet_name</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">gender</span><span class="o">]</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="n">render</span> <span class="ss">:text</span> <span class="o">=&gt;</span> <span class="n">csv_string</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>NOTE: <em>Developers using Ruby 1.8 &lt;= must install gem:fastercsv</em></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Dynamically Render Images with PHP]]></title>
    <link href="http://moorberry.net/blog/content-delivery-network/"/>
    <updated>2010-04-22T10:48:00-05:00</updated>
    <id>http://moorberry.net/blog/content-delivery-network</id>
    <content type="html"><![CDATA[<p>If youâ€™ve been frustrated with having to resize images for the sake of continuity or load time and donâ€™t want to develop an entire caching system than this post will be of great value to you.</p>

<!--more-->


<p>Today I will discusses the theory and resolve of applying a system to autonomously resize images, with the GD library for PHP, before they get requested by the browser.</p>

<p>This practice presents many benefits to its use.</p>

<ul>
<li>Save loads of hard drive space</li>
<li>Easy to resize div backgrounds</li>
<li>Faster to call than the use of <a href="http://moorberry.net/blog/server-vs-client">JavaScript</a>.</li>
</ul>


<br style="clear:both;" />


<h2>Calling the Application With HTML</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&quot;image.php?i=image.jpg&amp;s=500&quot;</span> <span class="nt">/&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Calling the php script is this easy. You can place this tag anywhere on any page and be able to display an image, with exact value constraints, and as many times as you need.</p>

<h2>Developing the image.php Application</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="n">header</span><span class="p">(</span><span class="s">&quot;Content-Type: image/jpeg&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>header() will make sure that the browser is aware how to handle the applicaton. Here it enables the page to be viewed as a jpeg source.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s">&#39;s&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span><span class='line'>    <span class="nv">$size</span> <span class="o">=</span> <span class="mi">160</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="nv">$size</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s">&#39;s&#39;</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nv">$image</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="n">list</span><span class="p">(</span><span class="nv">$width</span><span class="p">,</span> <span class="nv">$height</span><span class="p">)</span> <span class="o">=</span> <span class="n">getimagesize</span><span class="p">(</span><span class="nv">$image</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$ratio</span> <span class="o">=</span> <span class="nv">$width</span><span class="o">/</span><span class="nv">$height</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nv">$ratio</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nv">$newWidth</span>  <span class="o">=</span> <span class="nv">$size</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$newHeight</span> <span class="o">=</span> <span class="nv">$size</span><span class="o">/</span><span class="nv">$ratio</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="nv">$newHeight</span> <span class="o">=</span> <span class="nv">$size</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$newWidth</span>  <span class="o">=</span> <span class="nv">$size</span><span class="o">*</span><span class="nv">$ratio</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="c1"># creates a copy of the loaded image</span>
</span><span class='line'><span class="nv">$create</span> <span class="o">=</span> <span class="n">imagecreatefromjpeg</span><span class="p">(</span><span class="nv">$image</span><span class="p">);</span>
</span><span class='line'><span class="c1"># creates a blank template to work from</span>
</span><span class='line'><span class="nv">$template</span> <span class="o">=</span> <span class="n">imagecreatetruecolor</span><span class="p">(</span><span class="nv">$newWidth</span><span class="p">,</span><span class="nv">$newHeight</span><span class="p">);</span>
</span><span class='line'><span class="c1"># copies the original onto the new template</span>
</span><span class='line'><span class="n">imagecopyresized</span><span class="p">(</span><span class="nv">$template</span><span class="p">,</span> <span class="nv">$create</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$newWidth</span><span class="p">,</span> <span class="nv">$newHeight</span><span class="p">,</span> <span class="nv">$width</span><span class="p">,</span> <span class="nv">$height</span><span class="p">);</span>
</span><span class='line'><span class="c1"># displays the image</span>
</span><span class='line'><span class="n">ImageJpeg</span><span class="p">(</span><span class="nv">$template</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Usually I break this larger portion of my post up into smaller pieces so I can reference all the code being used and what it does. But the fundamentals are so well noted and easy to navigate, that I figured even if I left it as so, that you should have no problem implementing this into your own work.</p>

<h2>Error catching</h2>

<p>If source material is not working properly. Issue the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">function_exists</span><span class="p">(</span><span class="s">&#39;imagecreatetruecolor&#39;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>    <span class="nb">exit</span><span class="p">(</span><span class="s">&#39;Err, function : imagecreatetruecolor does not exist&#39;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>function_exists() will check the currently active Apache function repository, both internal and user-defined, to see if the listed function matches anything available.</p>

<p>If youâ€™re receiving the error message than the server youâ€™re running this code on does not support the GD library and you must either set it up manually or contact an administrator to do so for you.</p>

<p>Also note that only Jpeg formats are acceptable by this set up. Extending is not a difficult task. I only wanted you to understand the basics and be able to evolve with PHP from my writings.</p>

<h2>Summary</h2>

<p>Hopefully Iâ€™ve left more than enough room for you to adapt this into your own projects. You can add on to this with many of the GD library features documented by the PHP network.</p>

<p>If you develop an extension or even a class, from these tips, please feel free to share by commenting back and letting me know what youâ€™ve done.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Paypal Express Checkout NVP API]]></title>
    <link href="http://moorberry.net/blog/paypal-express-checkout-nvp-api/"/>
    <updated>2010-04-03T20:19:00-05:00</updated>
    <id>http://moorberry.net/blog/paypal-express-checkout-nvp-api</id>
    <content type="html"><![CDATA[<p>I&#8217;m not sure why <a href="http://paypal.com">Paypal</a> has written documentation, regarding its own Express Checkout name-value-pair API, with no enthusiasm at all. The classes used with the Paypal API are extremely easy to use. All of this is likely contributing to the confusion about using Express Checkout. But Iâ€™m here now, to save your application, and hopefully your sanity.</p>

<!--more-->




<div style="margin:0 auto 20px;width:600px;"><img src="http://moorberry.net/images/posts/checkout01.jpg" title="SendGrid" alt="SendGrid" width="100%" /></div>


<p>Iâ€™m going to explain why the API objects work and what happens when theyâ€™re called. Thereâ€™s a few different ways that you could go about setting up the product and/or service details. So Iâ€™ll keep this post relative to the main focus points and let you handle the before and after parts on an individual basis.</p>

<h2>Referring payment authentication</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="nv">$paypal</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SetExpressCheckout</span><span class="p">(</span><span class="nv">$totalPrice</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>We start out by calling the <strong>SetExpressCheckOut()</strong> class. This class caller instantiates the method youâ€™ll use to set up the parameters required for redirecting the customer <em>to</em> Paypal <em>and back</em>. A variable of the total price has to be set to complete the initiation of this class.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="nv">$paypal</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SetExpressCheckout</span><span class="p">(</span><span class="nv">$totalPrice</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$paypal</span><span class="o">-&gt;</span><span class="n">setNVP</span><span class="p">(</span><span class="s">&quot;RETURNURL&quot;</span><span class="p">,</span> <span class="s">&quot;http://yourURL.com/confirm.php&quot;</span><span class="p">);</span>
</span><span class='line'><span class="nv">$paypal</span><span class="o">-&gt;</span><span class="n">setNVP</span><span class="p">(</span><span class="s">&quot;HDRIMG&quot;</span><span class="p">,</span> <span class="s">&quot;http://yourURL.com/image.jpg&quot;</span><span class="p">);</span>
</span><span class='line'><span class="nv">$paypal</span><span class="o">-&gt;</span><span class="n">setNVP</span><span class="p">(</span><span class="s">&quot;EMAIL&quot;</span><span class="p">,</span> <span class="s">&quot;$userEmail&quot;</span><span class="p">);</span> <span class="sr">//</span> <span class="n">customer</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">email</span>
</span><span class='line'><span class="nv">$paypal</span><span class="o">-&gt;</span><span class="n">setNVP</span><span class="p">(</span><span class="s">&quot;AMT&quot;</span><span class="p">,</span> <span class="nv">$totalPrice</span><span class="p">);</span>
</span><span class='line'><span class="nv">$paypal</span><span class="o">-&gt;</span><span class="n">setNVP</span><span class="p">(</span><span class="s">&quot;SHIPPINGAMT&quot;</span><span class="p">,</span> <span class="s">&quot;32&quot;</span><span class="p">);</span>
</span><span class='line'><span class="nv">$paypal</span><span class="o">-&gt;</span><span class="n">setNVP</span><span class="p">(</span><span class="s">&quot;CUSTOM&quot;</span><span class="p">,</span> <span class="s">&quot;Anything you want to put&quot;</span><span class="p">);</span>
</span><span class='line'><span class="nv">$paypal</span><span class="o">-&gt;</span><span class="n">setNVP</span><span class="p">(</span><span class="s">&quot;INVNUM&quot;</span><span class="p">,</span> <span class="nv">$uniqueID</span><span class="p">);</span> <span class="sr">//</span> <span class="n">personal</span> <span class="n">invoice</span> <span class="n">number</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$paypal</span><span class="o">-&gt;</span><span class="n">getResponse</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>Before you submit for a transfer to Paypal, know that there are optional values you can send with the setNVP() function, to customize the payment process. All values that can be found, by default, in the etc/NVP/SetExpressCheckout.ini file. Iâ€™ve included a list of common practice examples and how to use them in this template.</p>

<p>getResponse() sends the userâ€™s browser to Paypal for authentication of credit information. Specifically to a URL that youâ€™ll have to variably set between test mode (sandbox) and live, in the file named etc/NVP/PayPalNVP.ini.</p>

<div style="margin:0 auto 20px;width:600px;"><img src="http://moorberry.net/images/posts/checkout02.jpg" title="SendGrid" alt="SendGrid" width="100%" /></div>


<h2>Completing the Sale</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="nv">$paypal</span>  <span class="o">=</span> <span class="k">new</span> <span class="n">GetExpressCheckoutDetails</span><span class="p">;</span>
</span><span class='line'><span class="nv">$details</span> <span class="o">=</span> <span class="nv">$paypal</span><span class="o">-&gt;</span><span class="n">getResponse</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>GetExpressCheckoutDetails()</strong> is a class that is most responsible for presenting the custom specifications that you originally sent with SetExpressCheckOut() and SetNVP().</p>

<p><strong>getResponse()</strong> will gather all of the available options as an array, labelled $details.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="nv">$payment</span>  <span class="o">=</span> <span class="k">new</span> <span class="n">DoExpressCheckoutPayment</span><span class="p">(</span><span class="nv">$totalPrice</span><span class="p">);</span>
</span><span class='line'><span class="nv">$response</span> <span class="o">=</span> <span class="nv">$payment</span><span class="o">-&gt;</span><span class="n">getResponse</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>DoExpressCheckoutPayment()</strong> will instinctively initiate a communication with Paypal to notify the service that you are ready for the payment to be transferred to your account. The only necessary requisite, of calling this class and it calling to action, is to include the total price in its variable containment field.</p>

<p><strong>getResponse()</strong> will gather the resulting responses by DoExpressCheckoutPayment() and include them in an array, labelled $response.</p>

<p>It could be said that you could apply another (final) verification for your customer to submit before the transaction is completed by DoExpressCheckoutPayment(). But not technically necessary.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nv">$response</span><span class="p">[</span><span class="s">&#39;PAYMENTSTATUS&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;Completed&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1"># process information</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>One of the returned values in $response will be the PAYMENTSTATUS key. This is a string result that confirms whether or not the money has made been payed to your account. It will definitely be useful when you set up your system to print an invoice on complete, or some insightfully-formatted summary on failure.</p>

<h2>Displaying results from getResponse</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="n">echo</span> <span class="s">&#39;&lt;pre&gt;&#39;</span><span class="p">;</span>
</span><span class='line'><span class="n">print_r</span><span class="p">(</span><span class="nv">$details</span><span class="p">);</span>
</span><span class='line'><span class="n">echo</span> <span class="s">&#39;&lt;pre&gt;&#39;</span><span class="p">;</span>
</span><span class='line'><span class="n">print_r</span><span class="p">(</span><span class="nv">$response</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># The above code should print out something similar to the following:</span>
</span><span class='line'>
</span><span class='line'><span class="n">Array</span>
</span><span class='line'><span class="p">(</span>
</span><span class='line'>    <span class="p">[</span><span class="n">TOKEN</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">EC</span><span class="nv">%2d8DS53628GJ4630109</span>
</span><span class='line'>    <span class="p">[</span><span class="n">TIMESTAMP</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">2010</span><span class="nv">%2d03%2d31T08%3a25%3a40Z</span>
</span><span class='line'>    <span class="p">[</span><span class="n">CORRELATIONID</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">ce3e460d38d2f</span>
</span><span class='line'>    <span class="p">[</span><span class="n">ACK</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">Success</span>
</span><span class='line'>    <span class="p">[</span><span class="n">VERSION</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">51</span><span class="nv">%2e0</span>
</span><span class='line'>    <span class="p">[</span><span class="n">BUILD</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">1247606</span>
</span><span class='line'>    <span class="p">[</span><span class="n">EMAIL</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">test_acct_36654645742_per</span><span class="nv">%40domain%2ecom</span>
</span><span class='line'>    <span class="p">[</span><span class="n">PAYERID</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">W96GXTA5P9BRN</span>
</span><span class='line'>    <span class="p">[</span><span class="n">PAYERSTATUS</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">verified</span>
</span><span class='line'>    <span class="p">[</span><span class="n">FIRSTNAME</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">Test</span>
</span><span class='line'>    <span class="p">[</span><span class="n">LASTNAME</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">User</span>
</span><span class='line'>    <span class="p">[</span><span class="n">COUNTRYCODE</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">US</span>
</span><span class='line'>    <span class="p">[</span><span class="n">SHIPTONAME</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">Test</span><span class="nv">%20User</span>
</span><span class='line'>    <span class="p">[</span><span class="n">SHIPTOSTREET</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="nv">%20Main%20St</span>
</span><span class='line'>    <span class="p">[</span><span class="n">SHIPTOCITY</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">San</span><span class="nv">%20Jose</span>
</span><span class='line'>    <span class="p">[</span><span class="n">SHIPTOSTATE</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">CA</span>
</span><span class='line'>    <span class="p">[</span><span class="n">SHIPTOZIP</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">95131</span>
</span><span class='line'>    <span class="p">[</span><span class="n">SHIPTOCOUNTRYCODE</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">US</span>
</span><span class='line'>    <span class="p">[</span><span class="n">SHIPTOCOUNTRYNAME</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">United</span><span class="nv">%20States</span>
</span><span class='line'>    <span class="p">[</span><span class="n">ADDRESSSTATUS</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">Confirmed</span>
</span><span class='line'>    <span class="p">[</span><span class="n">CUSTOM</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">Anything</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">put</span>
</span><span class='line'>    <span class="p">[</span><span class="n">INVNUM</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">IYUUFEOAS0ME3MTI</span>
</span><span class='line'><span class="p">)</span>
</span><span class='line'><span class="n">Array</span>
</span><span class='line'><span class="p">(</span>
</span><span class='line'>    <span class="p">[</span><span class="n">TOKEN</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">EC</span><span class="nv">%2d8DS53628GJ4630109</span>
</span><span class='line'>    <span class="p">[</span><span class="n">TIMESTAMP</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">2010</span><span class="nv">%2d03%2d31T08%3a25%3a43Z</span>
</span><span class='line'>    <span class="p">[</span><span class="n">CORRELATIONID</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">b1989df39a0ca</span>
</span><span class='line'>    <span class="p">[</span><span class="n">ACK</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">Success</span>
</span><span class='line'>    <span class="p">[</span><span class="n">VERSION</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">51</span><span class="nv">%2e0</span>
</span><span class='line'>    <span class="p">[</span><span class="n">BUILD</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">1247606</span>
</span><span class='line'>    <span class="p">[</span><span class="n">TRANSACTIONID</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="n">PR0061154034542X</span>
</span><span class='line'>    <span class="p">[</span><span class="n">TRANSACTIONTYPE</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">expresscheckout</span>
</span><span class='line'>    <span class="p">[</span><span class="n">PAYMENTTYPE</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">instant</span>
</span><span class='line'>    <span class="p">[</span><span class="n">ORDERTIME</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">2010</span><span class="nv">%2d03%2d31T08%3a25%3a42Z</span>
</span><span class='line'>    <span class="p">[</span><span class="n">AMT</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">152</span><span class="nv">%2e00</span>
</span><span class='line'>    <span class="p">[</span><span class="n">FEEAMT</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="nv">%2e71</span>
</span><span class='line'>    <span class="p">[</span><span class="n">TAXAMT</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="nv">%2e00</span>
</span><span class='line'>    <span class="p">[</span><span class="n">CURRENCYCODE</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">USD</span>
</span><span class='line'>    <span class="p">[</span><span class="n">PAYMENTSTATUS</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">Completed</span>
</span><span class='line'>    <span class="p">[</span><span class="n">PENDINGREASON</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">None</span>
</span><span class='line'>    <span class="p">[</span><span class="n">REASONCODE</span><span class="p">]</span> <span class="o">=&gt;</span> <span class="n">None</span>
</span><span class='line'><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Testing</h2>

<p>If you donâ€™t have a <a href="https://developer.paypal.com/">Paypal developer account</a>, than you should certainly sign up for one to use Paypalâ€™s Sandbox, which makes a mock version of Paypal available for testing. Comes complete with personal and business accounts, each with their own credentials, and unlimited funds.</p>

<h2>Summary</h2>

<p>Follow the preceding order and you could easily narrow this code down to a a single file, with enough if() constructs, or span it out to many.</p>

<p>You might be left wondering why it seems less daunting than you have expected. That would be because youâ€™re right. These few objects are all thatâ€™s needed to handle a shopping cart system on your website.</p>

<p>Maybe Paypal will use this post to refer new users trying to understand how this system works. But I doubt it.</p>

<h3>Note</h3>

<p>Don&#8217;t forget to adjust your database schema for <em>address2</em> in <strong>$details</strong> when available.</p>
]]></content>
  </entry>
  
</feed>
