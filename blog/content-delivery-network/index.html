
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Dynamically Render Images with PHP - Michael Minter</title>
  <meta name="author" content="Michael Minter">
  <link rel="author" href="humans.txt">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  
    
  
  <meta name="description" content="If you’ve been frustrated with having to resize images for the sake of continuity or load time and don’t want to develop an entire caching system &hellip;">
  
  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://moorberry.net/blog/content-delivery-network/">
  <link href="/favicon.png" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Cantarell' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Michael Minter" type="application/atom+xml">
  <meta name="og:type" content="website" />
  <meta name="og:site_name" content="Michael Minter" />
  <meta name="og:title" content="Dynamically Render Images with PHP" />
  <meta name="og:description" content="If you’ve been frustrated with having to resize images for the sake of continuity or load time and don’t want to develop an entire caching system &hellip;" />
  <meta name="og:url" content="http://moorberry.net/blog/content-delivery-network/"/>
  <meta name="url" content="http://moorberry.net/blog/content-delivery-network/">
  
  <meta name="subject" content="PHP"/>
  <meta name="category" content="PHP"/>
  
  <meta name="distribution" content="global">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

<link rel="stylesheet" type="text/css" href="/stylesheets/proudify.css" />
<link rel="stylesheet" type="text/css" href="/stylesheets/custom.css" />
<link rel="shortcut icon" href="http://www.gravatar.com/avatar/c40bf0fd76b6d591122a1dab3e88b0fd.png?s=16" title="Favicon" />

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34437469-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <nav role="navigation"><div class="navbar">
  <div class="navbar-inner">
    <a class="brand" href="/">Michael Minter</a>
    <ul class="nav">
      <li><a href="/">Home</a></li>
      <li><a href="/blog/archives">Archives</a></li>
    </ul>
    <ul class="nav" data-subscription="rss">
      <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
      
    </ul>
      
    <form class="navbar-form" action="http://google.com/search" method="get">
      <fieldset role="search">
        <input type="hidden" name="q" value="site:moorberry.net" />
        <input class="span2" type="text" name="q" results="0" placeholder="Search"/>
      </fieldset>
    </form>
      
    
  </div>
</div>
</nav>
  <div class="wrapper_single">
    <div class="container">
      <article class="span8 offset2" role="article">
        <div class="article-format">
  
    <header>
      
        <h1 class="entry-title">Dynamically Render Images With PHP</h1>
      
      
        <p class="meta">
          
  


  
    <span class="byline author vcard">by <span class="fn"><a href="/" target="_blank" alt="Homepage" title="Michael Minter">Michael Minter</a></span></span>
  

 - 
          








  


<time datetime="2010-04-22T10:48:00-05:00" pubdate data-updated="true">Apr 22<span>nd</span>, 2010</time> - 
          

posted in
<span class="categories">
  
    <a class='category' href='/blog/categories/php/'>PHP</a>
  
</span>


          
           | <a href="#disqus_thread">Comments</a>
          
        </p>
      
    </header>
  
  
  
    <div class="entry-content"><p>If you’ve been frustrated with having to resize images for the sake of continuity or load time and don’t want to develop an entire caching system than this post will be of great value to you.</p>

<!--more-->


<p>Today I will discusses the theory and resolve of applying a system to autonomously resize images, with the GD library for PHP, before they get requested by the browser.</p>

<p>This practice presents many benefits to its use.</p>

<ul>
<li>Save loads of hard drive space</li>
<li>Easy to resize div backgrounds</li>
<li>Faster to call than the use of <a href="/blog/server-vs-client">JavaScript</a>.</li>
</ul>


<br style="clear:both;" />


<h2>Calling the Application With HTML</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">&quot;image.php?i=image.jpg&amp;s=500&quot;</span> <span class="nt">/&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Calling the php script is this easy. You can place this tag anywhere on any page and be able to display an image, with exact value constraints, and as many times as you need.</p>

<h2>Developing the image.php Application</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="n">header</span><span class="p">(</span><span class="s">&quot;Content-Type: image/jpeg&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>header() will make sure that the browser is aware how to handle the applicaton. Here it enables the page to be viewed as a jpeg source.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s">&#39;s&#39;</span><span class="p">]))</span> <span class="p">{</span>
</span><span class='line'>    <span class="nv">$size</span> <span class="o">=</span> <span class="mi">160</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="nv">$size</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s">&#39;s&#39;</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="nv">$image</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s">&#39;i&#39;</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="n">list</span><span class="p">(</span><span class="nv">$width</span><span class="p">,</span> <span class="nv">$height</span><span class="p">)</span> <span class="o">=</span> <span class="n">getimagesize</span><span class="p">(</span><span class="nv">$image</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$ratio</span> <span class="o">=</span> <span class="nv">$width</span><span class="o">/</span><span class="nv">$height</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nv">$ratio</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nv">$newWidth</span>  <span class="o">=</span> <span class="nv">$size</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$newHeight</span> <span class="o">=</span> <span class="nv">$size</span><span class="o">/</span><span class="nv">$ratio</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="nv">$newHeight</span> <span class="o">=</span> <span class="nv">$size</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$newWidth</span>  <span class="o">=</span> <span class="nv">$size</span><span class="o">*</span><span class="nv">$ratio</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="c1"># creates a copy of the loaded image</span>
</span><span class='line'><span class="nv">$create</span> <span class="o">=</span> <span class="n">imagecreatefromjpeg</span><span class="p">(</span><span class="nv">$image</span><span class="p">);</span>
</span><span class='line'><span class="c1"># creates a blank template to work from</span>
</span><span class='line'><span class="nv">$template</span> <span class="o">=</span> <span class="n">imagecreatetruecolor</span><span class="p">(</span><span class="nv">$newWidth</span><span class="p">,</span><span class="nv">$newHeight</span><span class="p">);</span>
</span><span class='line'><span class="c1"># copies the original onto the new template</span>
</span><span class='line'><span class="n">imagecopyresized</span><span class="p">(</span><span class="nv">$template</span><span class="p">,</span> <span class="nv">$create</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$newWidth</span><span class="p">,</span> <span class="nv">$newHeight</span><span class="p">,</span> <span class="nv">$width</span><span class="p">,</span> <span class="nv">$height</span><span class="p">);</span>
</span><span class='line'><span class="c1"># displays the image</span>
</span><span class='line'><span class="n">ImageJpeg</span><span class="p">(</span><span class="nv">$template</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Usually I break this larger portion of my post up into smaller pieces so I can reference all the code being used and what it does. But the fundamentals are so well noted and easy to navigate, that I figured even if I left it as so, that you should have no problem implementing this into your own work.</p>

<h2>Error catching</h2>

<p>If source material is not working properly. Issue the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">function_exists</span><span class="p">(</span><span class="s">&#39;imagecreatetruecolor&#39;</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>    <span class="nb">exit</span><span class="p">(</span><span class="s">&#39;Err, function : imagecreatetruecolor does not exist&#39;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>function_exists() will check the currently active Apache function repository, both internal and user-defined, to see if the listed function matches anything available.</p>

<p>If you’re receiving the error message than the server you’re running this code on does not support the GD library and you must either set it up manually or contact an administrator to do so for you.</p>

<p>Also note that only Jpeg formats are acceptable by this set up. Extending is not a difficult task. I only wanted you to understand the basics and be able to evolve with PHP from my writings.</p>

<h2>Summary</h2>

<p>Hopefully I’ve left more than enough room for you to adapt this into your own projects. You can add on to this with many of the GD library features documented by the PHP network.</p>

<p>If you develop an extension or even a class, from these tips, please feel free to share by commenting back and letting me know what you’ve done.</p>
</div>
  
  
    <footer>
      <div style="border:#012b36 1px dashed;margin:40px 0;padding:20px 0 0 20px;">
        <p>I love sharing! This text is copyrighted under Creative Commons <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank">Attribution-Noncommercial-Share Alike 3.0 Unported</a> license, unless stated otherwise. </p>
        <p>Let me know how you use it - <a href="#footer-widgets">contact me here.</a></p>
      </div>
      
        <a class="pull-left" href="/blog/paypal-express-checkout-nvp-api/" title="Previous Post: Paypal Express Checkout NVP API">&laquo; Paypal Express Checkout NVP API</a>
      
      
        <a class="pull-right" href="/blog/export-csv/" title="Next Post: Export Data as CSV">Export Data as CSV &raquo;</a>
      
    </footer>
  
</div>

      </article>
      
      <style type="text/css">
        #ad_container {
          clear:both;
          height:90px;
          margin:0 auto;
          padding:0 0 0 60px;
          width:720px;
        }
      </style>
      
      <div id="ad_container">
        <script type="text/javascript"><!--
        google_ad_client = "ca-pub-7424434269432645";
        /* moorberry.net (octopress) */
        google_ad_slot = "8992473921";
        google_ad_width = 728;
        google_ad_height = 90;
        //-->
        </script>
        <script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
      </div>
    </div>
  </div>
  <div class="comments_wrapper"> 
    
      <section>
        <h1>Comments</h1>
        <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
      </section>
    
  </div>
  <div id="footer-widgets">
  <div class="container">
    <div class="row">
  <div class="span3">
    <h2>coderwall badges</h2>
<div id="proudify"></div>
<a href="http://coderwall.com/michaelminter" target="_blank"><img src="http://api.coderwall.com/michaelminter/endorsecount.png" alt="Endorse" id="endorse_button" /></a>
  </div>
  <div class="span3">
    <h2>github</h2>
<ul id="activity"></ul>
  </div>
  <div class="span4">
    <h2>twitter</h2>
<a href="https://twitter.com/mothore" class="twitter-follow-button" data-show-count="true" data-lang="en" target="_blank">Follow @mothore</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
<div class="tweet" data-twitter-user="mothore">
</div>
  </div>
  <div class="span2">
    <h2>found on</h2>
<a href="mailto:michael@moorberry.net" rel="tooltip" title="Email Michael"><img src="/images/glyphicons_399_e-mail.png" alt="email icon" class="social_icon"></a>


<a href="https://github.com/michaelminter/" rel="tooltip" title="Github"><img class="social_icon" title="Github" alt="github icon" src="/images/glyphicons_381_github.png"></a>







<a href="http://twitter.com/mothore" rel="tooltip" title="Twitter" target="_blank"><img class="social_icon" title="Twitter" alt="Twitter icon" src="/images/glyphicons_391_twitter_t.png"></a>








<a href="https://github.com/michaelminter/" rel="tooltip" title="Github" target="_blank"><img class="social_icon" title="Github" alt="github icon" src="/images/glyphicons_381_github.png"></a>
<a href="http://stackoverflow.com/users/388253/michael-minter" rel="tooltip" title="Stack Overflow" target="_blank"><img class="social_icon" title="Stack Overflow" alt="stack overflow icon" src="/images/glyphicons_400_stack_overflow.png"></a>
<a href="http://www.linkedin.com/in/mminter" rel="tooltip" title="Linkedin" target="_blank"><img class="social_icon" title="Linkedin" alt="Linkedin icon" src="/images/glyphicons_377_linked_in.png"></a>
<!--a href="https://plus.google.com/110730291563876857467" rel="tooltip" title="Google Plus"><img class="social_icon" title="Google Plus" alt="Google Plus icon" src="/images/glyphicons_386_google_plus.png"></a-->

<br /><br /><br />

<a href="http://stackoverflow.com/users/388253/michael-minter" target="_blank">
<img src="http://stackoverflow.com/users/flair/388253.png" width="170" alt="profile for Michael Minter at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for Michael Minter at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
</a>
  </div>
</div>

  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-left">
  All content is under Copyright &copy; 2010-2013 by the individual authors of this blog and is released<br />under the <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank">Attribution-Noncommercial-Share Alike 3.0 Unported</a> license.<br />
</p>
<p class="pull-right">
  <span>Powered by <a href="http://octopress.org/">Octopress</a>.</span>
  
    <!--span>Design by <a href="http://www.AdrianArtiles.com">Adrian Artiles</a>.</span-->
  
</p>

  </div>
</footer>

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript" src="/javascripts/jquery-proudify.min.js"></script>
<script>window.jQuery || document.write('<script src="/javascripts/libs/jquery-1.7.2.min.js" type="text/javascript"><\/script>')</script>
<script src="/javascripts/libs/bootstrap.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.tweet.js" type="text/javascript"></script>
<script src="/javascripts/jquery.instagram.js" type="text/javascript"></script>
<script src="/javascripts/libs/jquery.masonry.min.js" type="text/javascript"></script>
<script src="/javascripts/custom.js" type="text/javascript"></script>
<script type="text/javascript">
  $('#proudify').proudify({username:'michaelminter',service:'coderwall'});
</script>
<script type="text/javascript" src="/javascripts/jquery.timeago.js"></script>
<script type="text/javascript" src="/javascripts/jquery.github-activity.js"></script>
<script type="text/javascript">
  $(function() {
    $("ul#activity").githubActivityFor('michaelminter', {
      'limit': 3,
      'wrap': function(item) {
        item.prepend('<img src="/images/github_16.png" style="float:left;margin:0 5px 0 0;" />');
        return item
      }
    });
  });
</script>


<script type="text/javascript">
      var disqus_shortname = 'michaelminter';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://moorberry.net/blog/content-delivery-network/';
        var disqus_url = 'http://moorberry.net/blog/content-delivery-network/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>




</body>
</html>
