
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Airbrake: Send Error Notices using Javascript - Moorberry Solutions</title>
  <meta name="author" content="Michael Minter">

  
  <meta name="description" content="Airbrake, Javascript, Ruby on Rails, Sinatra Airbrake: Send Error Notices Using Javascript Right now you may be saying to yourself, &#8220;but why &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
	
  <meta name="og:type" content="website" />
  <meta name="og:site_name" content="Moorberry Solutions" />
  <meta name="og:title" content="Airbrake: Send Error Notices using Javascript" />
  <meta name="og:description" content="Airbrake, Javascript, Ruby on Rails, Sinatra Airbrake: Send Error Notices Using Javascript Right now you may be saying to yourself, &#8220;but why &hellip;" />
  <meta name="og:url" content="http://moorberry.net/blog/airbrake-error-notice-javascript/"/>
  <meta name="url" content="http://moorberry.net/blog/airbrake-error-notice-javascript/">
  
  <meta name="subject" content="AirbrakeJavascriptRuby on RailsSinatra"/>
  <meta name="category" content="AirbrakeJavascriptRuby on RailsSinatra"/>
  
  <meta name="distribution" content="global">
	 
  
  <link rel="canonical" href="http://moorberry.net/blog/airbrake-error-notice-javascript">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/styles.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Moorberry Solutions" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <script src="/javascripts/jquery.sidr.min.js"></script>
  <script src="/javascripts/ah-blue.js"></script>
	<script src="/javascripts/custom.js"></script>
  
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34437469-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head> 

<body   >
  <div class="aux-container">
    <a id="nav-toggle" href="#sidr"></a>
    <a id="search-toggle"></a>
</div>

<header class="header-container clearfix">
        <a href="/"><img src="/images/ah-frame.png" onerror="this.onerror=null; this.src='ah-frame.png'"></a>
</header>

  <div class="main-container">
    <div class="main wrapper clearfix">
    	
    	<aside>
			
			  	<div class="search-container">
					<form action="http://google.com/search" method="get">
						<fieldset role="search">
							<input type="hidden" name="q" value="site:moorberry.net" />
							<input class="search-field" type="text" name="q" results="0" placeholder=""/>
							<input class="submit" type="submit" value=""/>
						</fieldset>
					</form>
				</div>
			
		  <div id="main-nav">
	<nav>
		<ul>
			<li>
      	
					<h3>Recent Posts</h3>
<ul>
	
    <li>
    	<a href="/blog/rails-2-acts-as-paranoid/" title="Rails 2 and acts_as_paranoid">Rails 2 and Acts_as_paranoid</a>
    </li>
    
    <li>
    	<a href="/blog/android-javascript-debugging/" title="Android Javascript Debugging">Android Javascript Debugging</a>
    </li>
    
    <li>
    	<a href="/blog/openoffice-merge-and-sort-data/" title="OpenOffice: Merge and Sort Data">OpenOffice: Merge and Sort Data</a>
    </li>
    
    <li>
    	<a href="/blog/eloquent-ruby-book-review/" title="Book Review: Eloquent Ruby">Book Review: Eloquent Ruby</a>
    </li>
    
    <li>
    	<a href="/blog/send-text-message-through-email/" title="Send Text Message Through Email">Send Text Message Through Email</a>
    </li>
    
</ul>




<section class="well" id="google_adspace_container" style="border-top: 5px solid rgb(55, 77, 97);margin-top:15px;padding-top:15px;">
	<script type="text/javascript"><!--
	google_ad_client = "ca-pub-7424434269432645";
	/* moorberry-250x250 */
	google_ad_slot = "8000817928";
	google_ad_width = 250;
	google_ad_height = 250;
	//-->
	</script>
	<script type="text/javascript"
	src="//pagead2.googlesyndication.com/pagead/show_ads.js">
	</script>
</section>
				
      </li>
			<li>
       	<ul>
				  <li><span>Projects - </span><a href="http://www.codekindness.com" target="_blank">CodeKindness</a>
        	<li><span>Github - </span><a href="http://www.github.com/michaelminter" target="_blank">github.com/michaelminter</a></li>
          <li><span>Twitter - </span><a href="http://www.twitter.com/mothore" target="_blank">@mothore</a></li>
          <li><span>Email - </span><a href="mailto:michael@moorberry.net" target="_blank">michael at moorberry</a></li>
        </ul>
      </li>
    </ul>
  </nav>
</div>
		</aside>
		
      <div>
<article>
	<header>
  <div class="article-tags">
      

<span class="categories">
  
    <a class='category' href='/blog/categories/airbrake/'>Airbrake</a>, <a class='category' href='/blog/categories/javascript/'>Javascript</a>, <a class='category' href='/blog/categories/ruby-on-rails/'>Ruby on Rails</a>, <a class='category' href='/blog/categories/sinatra/'>Sinatra</a>
  
</span>


  </div>
  
    <h1>
      Airbrake: Send Error Notices Using Javascript
    </h1>
  
</header>
<section id="post-content">
	
		<p>Right now you may be saying to yourself, &#8220;but why not just use an AJAX request inside of my Javascript application or use the Image().src hack&#8230;&#8221;</p>

<!--more-->


<p>Well they don&#8217;t work across all medias.</p>

<p>You cannot issue requests through the XMLHttpRequest to other domains or subdomains. If you are issuing the request from www.foo.com you also need to target the request at www.foo.com and make certain to remember the www.</p>

<p>If you really need to hit another domain you can use <a href="http://en.wikipedia.org/wiki/JSONP" target="_blank">JsonP</a> where the browser utilizes the <code>&lt;script&gt;</code> tags ability to load scripts from a different domain. The loaded script then executes a callback function to give you the data. But for regular AJAX calls you cannot leave the source domain at all.</p>

<p>See the Wiki article on <a href="http://en.wikipedia.org/wiki/Same_origin_policy" target="_blank">Same Origin Policy</a></p>

<p>In your Rails/Sinatra application controller file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">notice</span> <span class="o">=</span> <span class="nx">params</span><span class="p">[</span><span class="o">:</span><span class="nx">notice</span><span class="p">]</span>
</span><span class='line'><span class="nx">url</span>    <span class="o">=</span> <span class="nx">URI</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;http://api.airbrake.io/notifier_api/v2/notices&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nx">request</span>              <span class="o">=</span> <span class="nx">Net</span><span class="o">::</span><span class="nx">HTTP</span><span class="o">::</span><span class="nx">Post</span><span class="p">.</span><span class="k">new</span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nx">path</span><span class="p">)</span>
</span><span class='line'><span class="nx">request</span><span class="p">.</span><span class="nx">content_type</span> <span class="o">=</span> <span class="s1">&#39;text/xml&#39;</span>
</span><span class='line'><span class="nx">request</span><span class="p">.</span><span class="nx">body</span>         <span class="o">=</span> <span class="s2">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;</span>
</span><span class='line'><span class="s2">                      &lt;notice version=\&quot;2.3\&quot;&gt;</span>
</span><span class='line'><span class="s2">                        &lt;api-key&gt;948fhc4h9f98f190a4d69fee945d8b133cc11&lt;/api-key&gt;</span>
</span><span class='line'><span class="s2">                        &lt;notifier&gt;</span>
</span><span class='line'><span class="s2">                          &lt;name&gt;Airbrake Notifier&lt;/name&gt;</span>
</span><span class='line'><span class="s2">                          &lt;version&gt;3.1.6&lt;/version&gt;</span>
</span><span class='line'><span class="s2">                          &lt;url&gt;http://api.airbrake.io&lt;/url&gt;</span>
</span><span class='line'><span class="s2">                        &lt;/notifier&gt;</span>
</span><span class='line'><span class="s2">                        &lt;error&gt;</span>
</span><span class='line'><span class="s2">                          &lt;class&gt;RuntimeError&lt;/class&gt;</span>
</span><span class='line'><span class="s2">                          &lt;message&gt;#{notice}&lt;/message&gt;</span>
</span><span class='line'><span class="s2">                          &lt;backtrace&gt;</span>
</span><span class='line'><span class="s2">                            &lt;line method=\&quot;public\&quot; file=\&quot;/testapp/app/models/user.rb\&quot; number=\&quot;53\&quot;/&gt;</span>
</span><span class='line'><span class="s2">                            &lt;line method=\&quot;index\&quot; file=\&quot;/testapp/app/controllers/users_controller.rb\&quot; number=\&quot;14\&quot;/&gt;</span>
</span><span class='line'><span class="s2">                          &lt;/backtrace&gt;</span>
</span><span class='line'><span class="s2">                        &lt;/error&gt;</span>
</span><span class='line'><span class="s2">                        &lt;request&gt;</span>
</span><span class='line'><span class="s2">                          &lt;url&gt;#{request.url}&lt;/url&gt;</span>
</span><span class='line'><span class="s2">                          &lt;component/&gt;</span>
</span><span class='line'><span class="s2">                          &lt;action/&gt;</span>
</span><span class='line'><span class="s2">                          &lt;cgi-data&gt;</span>
</span><span class='line'><span class="s2">                            &lt;var key=\&quot;SERVER_NAME\&quot;&gt;example.org&lt;/var&gt;</span>
</span><span class='line'><span class="s2">                            &lt;var key=\&quot;HTTP_USER_AGENT\&quot;&gt;Mozilla&lt;/var&gt;</span>
</span><span class='line'><span class="s2">                          &lt;/cgi-data&gt;</span>
</span><span class='line'><span class="s2">                        &lt;/request&gt;</span>
</span><span class='line'><span class="s2">                        &lt;server-environment&gt;</span>
</span><span class='line'><span class="s2">                          &lt;project-root&gt;/testapp&lt;/project-root&gt;</span>
</span><span class='line'><span class="s2">                          &lt;environment-name&gt;production&lt;/environment-name&gt;</span>
</span><span class='line'><span class="s2">                          &lt;app-version&gt;1.0.0&lt;/app-version&gt;</span>
</span><span class='line'><span class="s2">                        &lt;/server-environment&gt;</span>
</span><span class='line'><span class="s2">                      &lt;/notice&gt;&quot;</span>
</span><span class='line'><span class="nx">response</span> <span class="o">=</span> <span class="nx">Net</span><span class="o">::</span><span class="nx">HTTP</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nx">host</span><span class="p">,</span> <span class="nx">url</span><span class="p">.</span><span class="nx">port</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="nx">http</span><span class="o">|</span> <span class="nx">http</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">request</span><span class="p">)}</span>
</span></code></pre></td></tr></table></div></figure>


<p>In your javascript:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">airbrake</span><span class="p">(</span><span class="nx">notice</span><span class="p">){</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">airbrake</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span> <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;/api/v1/error&#39;</span><span class="p">,</span> <span class="nx">context</span><span class="o">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span> <span class="nx">cache</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="o">:</span> <span class="p">{</span> <span class="nx">notice</span><span class="o">:</span> <span class="nx">notice</span> <span class="p">}</span> <span class="p">});</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>To call this function, simply:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">airbrake</span> <span class="p">(</span><span class="s2">&quot;This goose won&#39;t cook.&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Some alternative error/message handlers include: <a href="http://loggly.com" target="_blank">Loggly</a>, <a href="https://papertrailapp.com/" target="_blank">Papertrail</a>, <a href="https://logentries.com/" target="_blank">Log Entries</a>, or better yet create your own with <a href="https://github.com/flyingmachine/whoops" target="_blank">Whoops</a> which later I&#8217;d like to research and develop upon for my own error catching application.</p>

		<div id="embedded-ad-container" style="clear:both;height:280px;margin:20px auto;padding:0;width:336px;">
			<script type="text/javascript"><!--
			google_ad_client = "ca-pub-7424434269432645";
			/* moorberry-embedded */
			google_ad_slot = "8712168324";
			google_ad_width = 336;
			google_ad_height = 280;
			//-->
			</script>
			<script type="text/javascript"
			src="//pagead2.googlesyndication.com/pagead/show_ads.js">
			</script>
	  </div>
	
</section>
<footer>
  <div class="article-date">
      








  


<time datetime="2013-02-19T12:46:00-06:00" pubdate data-updated="true">Feb 19<span>th</span>, 2013</time>
  </div>
</footer>

	
	  <section class="comments">
	    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
	  </section>
	
</article>
</div>

<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_floating_style addthis_counter_style" style="padding-top:10px;right:0;top:262px;">
  <a class="addthis_button_facebook_like" fb:like:layout="box_count"></a>
  <a class="addthis_button_tweet" tw:count="vertical"></a>
  <!--a class="addthis_button_google_plusone" g:plusone:size="tall"></a-->
  <!-- Place this tag where you want the +1 button to render. -->
  <div class="g-plusone" data-size="tall"></div>

  <!-- Place this tag after the last +1 button tag. -->
  <script type="text/javascript">
    (function() {
      var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
      po.src = 'https://apis.google.com/js/platform.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
    })();
  </script>
  <a class="addthis_counter"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=xa-51685d3f427968b8"></script>
<!-- AddThis Button END -->

    </div>
  </div>
  <footer class="main-footer">
	<section class="interior-footer">
		<span class="credit">Powered by <a href="http://octopress.org" target="_blank" title="Octopress">Octopress</a></span>
	</section>
</footer>


  


<script type="text/javascript">
      var disqus_shortname = 'michaelminter';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://moorberry.net/blog/airbrake-error-notice-javascript/';
        var disqus_url = 'http://moorberry.net/blog/airbrake-error-notice-javascript/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




</body>
</html>
